<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="jquery.min.js"></script>
    <title>ë‚ ì”¨ ê²€ìƒ‰</title>
	<style>
		img {
			max-width: 60vw;
			max-height: 60vh;
		}
		body {
			display: flex;
			padding: 20px;
			justify-content: center;
			align-items: center;
		}
		h3 {
			text-align: center;
		}
		#wrapper {
			width: 80vw;
			height: 80vh;
			padding: 20px;
			border: 2px solid black;
			border-radius: 20px;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 10px;
		}
		#ê²°ê³¼ì°½ {
			display: none;
			flex-direction: column;
			align-items: center;
			gap: 5px;
		}
		.ì„¹ì…˜1 {
			display: flex;
			flex-direction: row;
			align-items: center;
		}
		.ì„¹ì…˜2 {
			display: flex;
			gap: 10px;
		}
		.ì„¹ì…˜2 span {
			background-color: greenyellow;
			width: 80px;
			height: 25px;
			line-height: 25px;
			border-radius: 20px;
			font-size: 12px;
			text-align: center;
		}
	</style>
    <script>
		//$.get, $.post...$.load, $.getJSON, $.ajax

		let state = { ë„ì‹œ:new Array(), ì„ì‹œ:new Object() };
		let Q = (x,y=document) => y.querySelector(x);
		let Elem = (config) => {
			const {tag='div', text='', class:className='', ...attrs} = config;
			el = document.createElement(tag);
			el.innerText = text;
			el.className = className;
			Object.keys(attrs).forEach(attr => el.setAttribute(attr, attrs[attr]));
			return el;
		}

        $(document).ready(function(){
            getData();
        })

        function getData() {
			$.getJSON('kr.json')
			.done(res => state.ë„ì‹œ = res)
			.done(main);
        }

		function main() {
			Q('body').append( Elem({id:'wrapper'}) );
			Q('#wrapper').append( c_search() );
			Q('#wrapper').append( c_result() );
		}

		function c_search() {
			ì»¨í…Œì´ë„ˆ = Elem({id:'search', id:'ê²€ìƒ‰ì°½'});
				íƒ€ì´í‹€ = Elem({tag:'h3', text:'ì˜¤ëŠ˜ì˜ ë‚ ì”¨'});
				ë°•ìŠ¤ = Elem({tag:'input', id:'ê²€ìƒ‰ì–´', placeholder:'ì§€ì—­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'});
				ê²€ìƒ‰ = Elem({tag:'button', id:'ê²€ìƒ‰', text:'ğŸ”'});

			ê²€ìƒ‰.addEventListener('click', search);

			[íƒ€ì´í‹€, ë°•ìŠ¤, ê²€ìƒ‰].forEach(el => ì»¨í…Œì´ë„ˆ.append(el));
			return ì»¨í…Œì´ë„ˆ;
		}

		function c_result() {
			ì»¨í…Œì´ë„ˆ = Elem({id:'result', id:'ê²°ê³¼ì°½'});
				ì´ë¦„ = Elem({tag:'sapn', id:'ì´ë¦„'});
				ì„¹ì…˜1 = Elem({class:'ì„¹ì…˜1'});
					ì´ë¯¸ì§€ = Elem({tag:'img', id:'ì´ë¯¸ì§€'});
					ì˜¨ë„ = Elem({tag:'span', id:'ì˜¨ë„'});
				ì„¹ì…˜2 = Elem({class:'ì„¹ì…˜2'});
					ì²´ê° = Elem({tag:'span', id:'ì²´ê°'});
					ìŠµë„ = Elem({tag:'span', id:'ìŠµë„'});
					ë°”ëŒ = Elem({tag:'span', id:'ë°”ëŒ'});

			[ì´ë¯¸ì§€, ì˜¨ë„].forEach(el => ì„¹ì…˜1.append(el));
			[ì²´ê°, ìŠµë„, ë°”ëŒ].forEach(el => ì„¹ì…˜2.append(el));
			[ì´ë¦„, ì„¹ì…˜1, ì„¹ì…˜2].forEach(el => ì»¨í…Œì´ë„ˆ.append(el));

			return ì»¨í…Œì´ë„ˆ;
		}

		function search() {
			const ì§€ëª… = Q('#ê²€ìƒ‰ì–´').value || 'ì„œìš¸';
			const ë„ì‹œ =  state.ë„ì‹œ[
					Object.keys(state.ë„ì‹œ).filter(key => state.ë„ì‹œ[key].alter.includes(ì§€ëª…))[0]
				].original
			
			Q('#ì´ë¦„').innerText = ë„ì‹œ;
			$.ajax({
				url: `https://api.openweathermap.org/data/2.5/weather?q=${ë„ì‹œ}&APPID=a0cd335023e5654308fd81198ce68f9c`,
				type: 'GET',
			})
			.done(res => {
				Q('#ì´ë¯¸ì§€').src = `https://openweathermap.org/img/wn/${res.weather[0].icon}@2x.png`;
				Q('#ì˜¨ë„').innerText = `${Math.round((res.main.temp - 273.15)*10)/10}Âºc`;
				Q('#ì²´ê°').innerText = `ì²´ê°: ${Math.round((res.main.feels_like - 273.15)*10)/10}Âºc`;
				Q('#ìŠµë„').innerText = `ìŠµë„: ${res.main.humidity}%`;
				Q('#ë°”ëŒ').innerText = `í’ì†: ${res.wind.speed}`;
				Q('#ê²°ê³¼ì°½').style.display = 'flex';
				console.log(res);
			})
		}
    </script>
</head>
<body>
</body>
</html>
