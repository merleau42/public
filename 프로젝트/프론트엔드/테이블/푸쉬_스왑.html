<html>
<head>
<style>
	*
	{
		text-align: center;
		font-size: 15;
		padding: 0;
	}
	div
	{
		margin-bottom: 20px;
		display: flex;
        align-items: center;
    }
	div *
	{
		min-width: 35px;
		height: 25px;
	}
	textarea
	{
		width: 450px;
		resize: none;
	}
	input
	{
		color: green;
		margin-left: 4px;
	}
	table
	{
		margin-bottom: 10px;
		border-spacing: 15px 0;
		border: 0;
	}
	td
	{
		border: 1px solid cornflowerblue;
		background: aliceblue;
		padding: 2;
		min-width: 30px;
		height: 30px;
		user-select: none;
	}
	td:hover
	{
		background-color: lightcyan;
	}
</style>
<script>
	let Q = (x, y=document) => y.querySelector(x);
	let QQ = (x, y=document) => [...y.querySelectorAll(x)];
	window.addEventListener('DOMContentLoaded',	main)
	function main()
	{
		arr_to_tr([], tr_A);
		arr_to_tr([], tr_B);
		arr_origin.value = '17,16,75,554,13,72,11';

		Q('input[value=초기화]').addEventListener('click', restart);
		Q('input[value=정규화]').addEventListener('click', normailize);
		Q('input[value=표간격]').addEventListener('click', collapse);
		Q('input[value=새로고침').addEventListener('click', collapse);

		Q('input[value=pb]').addEventListener('click', pb);
		Q('input[value=sa]').addEventListener('click', sa);
		QQ('input[value=ss]')[0].addEventListener('click', ss);
		Q('input[value=ra]').addEventListener('click', ra);
		QQ('input[value=rr]')[0].addEventListener('click', rr);
		Q('input[value=rra]').addEventListener('click', rra);
		QQ('input[value=rrr]')[0].addEventListener('click', rrr);
		
		Q('input[value=pa]').addEventListener('click', pa);
		Q('input[value=sb]').addEventListener('click', sb);
		QQ('input[value=ss]')[1].addEventListener('click', ss);
		Q('input[value=rb]').addEventListener('click', rb);
		QQ('input[value=rr]')[1].addEventListener('click', rr);
		Q('input[value=rrb]').addEventListener('click', rrb);
		QQ('input[value=rrr]')[1].addEventListener('click', rrr);

		mouse_listner();
		// setInterval(debug_monitor, 100);
		// collapse();
		// collapse();
	}
	function restart()
	{
		arr_A.value='';
		arr_B.value='';

		arr_A.value = arr_origin.value;
		arr_to_tr(arr_A.value.split(','), tr_A);
		arr_to_tr(arr_B.value.split(','), tr_B);

		logged.innerText = 'START';
	}
	function normailize()
	{
		origin = arr_origin.value.split(',');
		norm = new Array( origin.length );
		origin.map((x,i) => [x*1, i]).toSorted((a,b) => a[0] - b[0]).forEach((x,i) => norm[x[1]] = i);
		arr_origin.value = norm;
	}
	function arr_to_tr(arr, tr)
	{
		tr.innerHTML='';
		start = document.createElement('td')
		start.innerText="FRONT\nㅡ>";
		start.style.fontSize="10";
		start.style.color = 'gray';
		tr.appendChild( start )
		if (arr.length==1 && arr[0] == '')
			arr = [];
		arr.forEach(x => {
			td = document.createElement('td');
			td.innerText = x;
			td.setAttribute("draggable", true)
			tr.appendChild(td);
		});
		end = document.createElement('td')
		end.style.color = 'gray';
		end.style.fontSize="10";
		end.innerText="TOP\n<ㅡ";
		tr.appendChild( end )
		return tr;
	}
	function sa()
	{
		A = arr_A.value.split(',');
		if (A.length < 2)
			return ;
		
		tmp1 = A.pop();
		tmp2 = A.pop();
		A.push(tmp1);
		A.push(tmp2);

		arr_A.value = A;
		arr_to_tr(A, tr_A);

		logged.innerText += '\nsa';
	}
	function sb()
	{
		B = arr_B.value.split(',');
		if (B.length < 2)
			return ;
		
		tmp1 = B.pop();
		tmp2 = B.pop();
		B.push(tmp1);
		B.push(tmp2);

		arr_B.value = B;
		arr_to_tr(B, tr_B);

		logged.innerText += '\nsb';
	}
	function ss()
	{
		A = arr_A.value.split(',');
		B = arr_B.value.split(',');
		if (A.length < 2 || B.length < 2)
			return ;

		tmp1 = A.pop();
		tmp2 = A.pop();
		A.push(tmp1);
		A.push(tmp2);

		tmp1 = B.pop();
		tmp2 = B.pop();
		B.push(tmp1);
		B.push(tmp2);

		arr_B.value = B;
		arr_to_tr(B, tr_B);

		arr_A.value = A;
		arr_to_tr(A, tr_A);

		logged.innerText += '\nss';
	}
	function ra()
	{
		A = arr_A.value.split(',');
		if (A.length < 2)
			return ;
		A.push( A[0] );
		A.shift();

		arr_A.value = A;
		arr_to_tr(A, tr_A);

		logged.innerText += '\nra';
	}
	function rb()
	{
		B = arr_B.value.split(',');
		if (B.length < 2)
			return ;
		B.push( B[0] );
		B.shift();

		arr_B.value = B;
		arr_to_tr(B, tr_B);

		logged.innerText += '\nrb';
	}
	function rr()
	{
		A = arr_A.value.split(',');
		B = arr_B.value.split(',');
		if (A.length < 2 || B.length < 2)
			return ;

		A.push( A[0] );
		A.shift();

		arr_A.value = A;
		arr_to_tr(A, tr_A);

		B.push( B[0] );
		B.shift();

		arr_B.value = B;
		arr_to_tr(B, tr_B);

		logged.innerText += '\nrr';
	}
	function rra()
	{
		A = arr_A.value.split(',');
		if (A.length < 2)
			return ;

		A.unshift(A.pop());

		arr_A.value = A;
		arr_to_tr(A, tr_A);

		logged.innerText += '\nrra';
	}
	function rrb()
	{
		B = arr_B.value.split(',');
		if (B.length < 2)
			return ;

		B.unshift(B.pop());

		arr_B.value = B;
		arr_to_tr(B, tr_B);

		logged.innerText += '\nrrb';
	}
	function rrr()
	{
		A = arr_A.value.split(',');
		B = arr_B.value.split(',');
		if (A.length < 2 || B.length < 2)
			return ;
		rra();
		rrb();
	}
	function pb()
	{
		A = arr_A.value.split(',');
		B = arr_B.value.split(',');

		if (A.length==1 && A[0] == '')
			return ;

		if (B.length==1 && B[0] == '')
			B = [];

		B.push(A.pop());
		
		arr_A.value = A;
		arr_B.value = B;
		arr_to_tr(A, tr_A);
		arr_to_tr(B, tr_B);

		logged.innerText += '\npb';
	}
	function pa()
	{
		A = arr_A.value.split(',');
		B = arr_B.value.split(',');

		if (A.length==1 && A[0] == '')
			A = [];
		
		if (B.length==1 && B[0] == '')
			return ;

		A.push(B.pop());
		
		arr_A.value = A;
		arr_B.value = B;
		arr_to_tr(A, tr_A);
		arr_to_tr(B, tr_B);

		logged.innerText += '\npa';
	}
	function collapse()
	{
		toggle = {'collapse':'', '':'collapse'};
		document.querySelectorAll('table').forEach(x => x.style.borderCollapse = toggle[x.style.borderCollapse]);
	}
</script>
</head>
<body>
<div>
	<textarea id="arr_origin"></textarea>
	<input type="button" value="초기화">
	<input type="button" value="무작위">
	<input type="button" value="정규화">
	<input type="button" value="표간격">
	<input type="button" value="새로고침">
</div>
<table>
	<tr id="tr_A"></tr>
</table>
<table>
	<tr id="tr_B"></tr>
</table>
<div></div>
<div>
	<textarea id="arr_A"></textarea>
	<input type="button" value="pb">&nbsp;/
	<input type="button" value="sa">
	<input type="button" value="ss">&nbsp;/
	<input type="button" value="ra">
	<input type="button" value="rr">&nbsp;/
	<input type="button" value="rra">
	<input type="button" value="rrr">
</div>
<div>
	<textarea id="arr_B"></textarea>
	<input type="button" value="pa">&nbsp;/
	<input type="button" value="sb">
	<input type="button" value="ss">&nbsp;/
	<input type="button" value="rb">
	<input type="button" value="rr">&nbsp;/
	<input type="button" value="rrb">
	<input type="button" value="rrr">
</div>
<div id="logged"></div>
</body>
</html>