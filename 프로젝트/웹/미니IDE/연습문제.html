<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		body {
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
		}
		.ì¹´ë“œ {
			display: flex;
			flex-direction: column;
			width: 80vw;
			max-width: 700px;
			height: 40vh;
			gap: 10px;
			text-align: center;
			margin-top: 15px;
		}
		.ë²ˆí˜¸ {
			height: 10%;
		}
		.ì„¹ì…˜ {
			display: grid;
			grid-template-columns: 2fr 1fr;
			justify-items: center;
		}
		.ì„¹ì…˜1, .ì„¹ì…˜2 {
			width: 95%;
		}
		.ì„¹ì…˜1 {
			display: flex;
			flex-direction: column;
			gap: 5px;
		}
		textarea, input[type="text"] {
			padding: 3px;
			font-size: 14px;
			font-family:'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
		}
		.ì½”ë“œ {
			height: 20vh;
		}
		.ì…ë ¥ë¼ì¸ {
			display: flex;
			justify-content: center;
			align-items: center;
			gap: 5px;
		}
		.ì…ë ¥ {
			width: 75%;
			height: 2vh;
			min-height: 25px;
		}
		.ì‹¤í–‰ {
			width: 25%;
			height: 3vh;
			min-height: 25px;
		}
		.ì¶œë ¥ {
			height: 10vh;
		}
		.ë¬¸ì œ {
			height: 100%;
			width: 100%;
			font-size: 20px;
			font-family: 'Gothic';
		}
		.êµ¬ë¶„ {
			margin: auto;
			margin-top: 15px;
			width: 85%;
			border-bottom: 1px solid #bbb;
		}
		.ìƒë‹¨ë°” {
			display: flex;
			justify-content: center;
			align-items: center;
			width: 100%;
			height: 4vh;
			background: #ccc;
			gap: 5px;
		}
		.ì €ì¥í•˜ê¸°, .ë¶ˆëŸ¬ì˜¤ê¸°, .ê¸°ë³¸ë¬¸ì œ {
			font-size: 19px;
			cursor: pointer;
		}
	</style>
	<script>
		let Q = (x,y=document) => y.querySelector(x);
		let Elem = (config) => {
			const {tag='div', text='', class:className='', ...attrs} = config;
			el = document.createElement(tag);
			el.innerText = text;
			el.className = className;
			Object.keys(attrs).forEach(attr => el.setAttribute(attr, attrs[attr]));
			return el;
		}
		let input;
		let activated_index;

		document.addEventListener('DOMContentLoaded', main);

		let quest = [{ë²ˆí˜¸:'', ì½”ë“œ:'ğŸ“‚ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ì—°ìŠµë¬¸ì œë¥¼ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”', ì…ë ¥:'ì…ë ¥ê°’ì€ ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ êµ¬ë¶„í•´ì£¼ì„¸ìš”'}];

		function main() {
			Q('body').appendChild( navi() );
			refresh();
		}

		function refresh() {
			if (Q('#list')) Q('body').removeChild(Q('#list'));
			Q('body').appendChild( Elem({id:'list'}) );
			quest.forEach(info => Q('#list').appendChild(problem(info)));
		}

		function problem(info) {
			console.log(info);
			ì¹´ë“œ = Elem({class:'ì¹´ë“œ'});
				ë²ˆí˜¸ = Elem({tag:'h3', class:'ë²ˆí˜¸', text:`ì—°ìŠµë¬¸ì œ ${info?.ë²ˆí˜¸}`});
				ì„¹ì…˜ = Elem({class:'ì„¹ì…˜'});
					ì„¹ì…˜1 = Elem({class:'ì„¹ì…˜1 ì½”ë”©íŒŒíŠ¸'});
						ì½”ë“œ = Elem({tag:'textarea', class:'ì½”ë“œ', placeholder:'ì½”ë“œ', text:info?.ì½”ë“œ, index:info?.ë²ˆí˜¸});
						ì…ë ¥ë¼ì¸ = Elem({class: 'ì…ë ¥ë¼ì¸'});
							ì…ë ¥ = Elem({tag:'input', type:'text', class:'ì…ë ¥', placeholder:'ì…ë ¥ê°’', value:info?.ì…ë ¥??'', index:info?.ë²ˆí˜¸});
							ì‹¤í–‰ = Elem({tag:'input', type:'button', class:'ì‹¤í–‰', value:'ì‹¤í–‰', index:info?.ë²ˆí˜¸});
						ì¶œë ¥ = Elem({tag:'textarea', class:'ì¶œë ¥', placeholder:'ì¶œë ¥', index:info?.ë²ˆí˜¸});
					ì„¹ì…˜2 = Elem({class:'ì„¹ì…˜2'});
						ë¬¸ì œ = Elem({tag:'textarea', class:'ë¬¸ì œ', placeholder:'ë¬¸ì œ', text:info?.ë¬¸ì œ, index:info?.ë²ˆí˜¸});
				êµ¬ë¶„ = Elem({class:'êµ¬ë¶„'});


			ì‹¤í–‰.addEventListener('click', e => {
				const index = e.target.getAttribute('index');
				const code = Q(`.ì½”ë“œ[index="${index}"]`).value;
				activated_index = index;

				Q(`.ì¶œë ¥[index="${index}"]`).value = '';
				input = Q(`.ì…ë ¥[index="${index}"]`).value.split(' ');

				eval(code);
			});

			[ì½”ë“œ, ì…ë ¥, ë¬¸ì œ].forEach(el => el.addEventListener('change', e => {
				const index = e.target.getAttribute('index');
				state = quest.filter(x => x.ë²ˆí˜¸ == index)[0];
				state.ì½”ë“œ = Q(`.ì½”ë“œ[index="${index}"]`).value;
				state.ì…ë ¥ = Q(`.ì…ë ¥[index="${index}"]`).value;
				state.ë¬¸ì œ = Q(`.ë¬¸ì œ[index="${index}"]`).value;
			}));

			[ì…ë ¥, ì‹¤í–‰].forEach(el => ì…ë ¥ë¼ì¸.appendChild(el));
			[ì½”ë“œ, ì…ë ¥ë¼ì¸, ì¶œë ¥].forEach(el => ì„¹ì…˜1.appendChild(el));
			[ë¬¸ì œ].forEach(el => ì„¹ì…˜2.appendChild(el));
			[ì„¹ì…˜1, ì„¹ì…˜2].forEach(el => ì„¹ì…˜.appendChild(el));
			[ë²ˆí˜¸, ì„¹ì…˜, êµ¬ë¶„].forEach(el => ì¹´ë“œ.appendChild(el));

			return ì¹´ë“œ;
		}

		function navi() {
			ìƒë‹¨ë°” = Elem({tag: 'nav', class: 'ìƒë‹¨ë°”'});
				ì €ì¥í•˜ê¸° = Elem({class: 'ì €ì¥í•˜ê¸°', text: 'ğŸ’¾'});
				ë¶ˆëŸ¬ì˜¤ê¸° = Elem({class: 'ë¶ˆëŸ¬ì˜¤ê¸°', text: 'ğŸ“‚'});
				ê¸°ë³¸ë¬¸ì œ = Elem({class: 'ê¸°ë³¸ë¬¸ì œ', text: 'ğŸ“„'});
				
			ì €ì¥í•˜ê¸°.addEventListener('click', ()=>{
				const blob = new Blob([JSON.stringify(quest, null, 2)], { type: 'application/json' });
				const url = URL.createObjectURL(blob);

				Elem({tag: 'a', href: url, download: 'exercise.json'}).click();
				URL.revokeObjectURL(url);
			});

			ë¶ˆëŸ¬ì˜¤ê¸°.addEventListener('click', () => {
				const load = Elem({ tag: 'input', type: 'file', accept: 'application/json' });

				load.addEventListener('change', () => {
					const reader = new FileReader();
					reader.onload = () => {
						quest = JSON.parse(reader.result);
						refresh();
					}
					reader.readAsText(load.files[0]);
				});

				load.click();
			});

			ê¸°ë³¸ë¬¸ì œ.addEventListener('click', () => {
				fetch('ë¬¸ì œ.json')
				.then(res => res.json() )
				.then(res => quest = res )
				.then(_ => refresh());
			});

			[ì €ì¥í•˜ê¸°, ë¶ˆëŸ¬ì˜¤ê¸°, ê¸°ë³¸ë¬¸ì œ].forEach(el => ìƒë‹¨ë°”.appendChild(el));
			return ìƒë‹¨ë°”;
		}

		function log(msg) {
			Q(`.ì¶œë ¥[index="${activated_index}"]`).value += `${msg}\n`;
		}
	</script>
</head>
<body>
</body>
</html>
