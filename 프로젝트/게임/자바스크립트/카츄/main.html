<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>동물 퍼즐 - Flex 기반</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
    }

    .grid-container {
      display: flex;
      flex-wrap: wrap;
      gap: 4vh 25px;
      justify-content: center;
      width: 100%;
      margin: 0 auto;
    }

    .statement-container {
      display: flex;
      align-items: center;
      min-height: 45px;
      width: max(31vw, 50vh);
      max-width: 40vw;
    }

    .circle {
      width: max(45px, min(12vh, 13vw));
      height: max(45px, min(12vh, 13vw));
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #4a90e2;
      background-color: white;
      flex-shrink: 0;
      margin: 0 min(7.5px, max(3.5px, 1.5vh));
    }

    .circle img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .speech-bubble {
      background: white;
      border: 2px solid #ccc;
      border-radius: 10px;
      padding: min(11px, max(3.5px, 1.5vh));
      width: 100%;
      height: min(100px, max(45px, 12vh));
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
      word-break: keep-all;
      font-size: min(15px, max(0.8vw, max(12px, 1.8vh)));
    }

    .statement-container.reverse {
        flex-direction: row-reverse;
    }


    #debug {
        display: inline;
        float: left;
    }

  </style>
</head>
<body>

    <div class="grid-container" id="grid"></div>
    <div id="debug">디버그</div>

<script>
    Q = (x, y=document) => y.querySelector(x);
    QQ = (x, y=document) => [...y.querySelectorAll(x)];

    range = (a, l=0, d=1) => [...Array(abs(l - a)/d)].map((_,i)=>l ? a*1 + d * i * sign(l - a) : d * i * sign(a));
    natural = (n, m=undefined) => m ? range(+n, (+m)+1) : range(1, (+n)+1);
    vector = (n, f=()=>0) => [...Array(n)].map((_,i)=>f(i,n));
    matrix = (rows, cols, f=()=>0) => vector(rows).map((_,i) => vector(cols).map((_,j) => f(i,j,rows,cols)));

    randz = (min, max, arr=0) => arr ? range(arr).map(x => randz(min,max)) : floor(random() *(max - min + 1)) + min;
</script>    


  <script>
    const container = document.getElementById('grid');
    const totalItems = 12;

    const animals = Array.from({ length: totalItems }, (_, i) => ({
      src: `assets/동물${i + 1}.png`,
      text: `문장 ${(i + 1) % 8 + 1}은 ${((i + 1) * 13 % 2 === 0) ? '참' : '거짓'}이다.`
    }));

    for (let i = 0; i < animals.length; i++) {
      const animal = animals[i];

      const wrapper = document.createElement('div');
      wrapper.className = 'statement-container';

      const circle = document.createElement('div');
      circle.className = 'circle';

      const img = document.createElement('img');
      img.src = animal.src;
      img.alt = `동물${i + 1}`;
      circle.appendChild(img);

      const bubble = document.createElement('div');
      bubble.className = 'speech-bubble';
      bubble.textContent = animal.text;

      wrapper.appendChild(circle);
      wrapper.appendChild(bubble);
      container.appendChild(wrapper);
    }
  </script>
  <script>
    function getColumnCount() {
        const items = QQ('.statement-container');
        const rowTops = new Set();

        items.forEach(item => {
            rowTops.add(item.offsetTop);
        });

        const columnCount = items.length / rowTops.size;
        return Math.round(columnCount);
    }

    function updateLayoutBasedOnColumn() {
        QQ('.reverse').forEach(x => x.classList.remove('reverse'));

        const count = getColumnCount();
        const items = QQ('.statement-container').filter((_, i) => i % 2 === 1);

        if (count === 2)
            items.forEach(el => el.classList.add('reverse'));
    }

    // 초기 및 리사이즈 반응
    updateLayoutBasedOnColumn();
    window.addEventListener('resize', updateLayoutBasedOnColumn);

  </script>

</body>
</html>
