<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>논리 퍼즐 플랫폼</title>
  <style>
    * {
      box-sizing: border-box;
    }
    html {
      overflow: auto;
      scrollbar-width: none;    /* Firefox: 스크롤바 숨김 */
      -ms-overflow-style: none; /* IE/Edge 구버전 */
    }
    html::-webkit-scrollbar {
      display: none;            /* Chrome, Safari, Edge */
    }
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
    }

    .grid-container {
      display: flex;
      flex-wrap: wrap;
      gap: 4vh 22px;
      justify-content: center;
      width: 100%;
      margin: 0 auto;
    }

    .statement-container {
      display: flex;
      align-items: center;
      min-height: 40px;
      width: max(215px, 31vw, 50vh);
      max-width: max(215px, min(40vw, 400px));
    }

    .circle {
      width: max(65px, min(12vh, 13vw));
      height: max(65px, min(12vh, 13vw));
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #4a90e2;
      background-color: white;
      flex-shrink: 0;
      margin: 0 min(7.5px, max(3px, 1.5vh));
    }

    .circle img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .speech-bubble {
      background: white;
      border: 2px solid #ccc;
      border-radius: 10px;
      padding: min(11px, max(3.5px, 1.5vh)) 3.5px;
      width: 100%;
      height: min(100px, max(50px, 12vh));
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
      word-break: keep-all;
      display: flex;
      font-size: max(12px, min(19px, max(1.3vw, 1.7vh)));
      line-height: 1.3;
      align-items: center;     /* 수직 정렬 */
      justify-content: center; /* 수평 가운데 정렬1 */
      text-align: center;      /* 수평 가운데 정렬2 */
    }

    .statement-container.reverse {
        flex-direction: row-reverse;
    }


    #debug {
        display: inline;
        float: left;
    }

  </style>
</head>
<body>

    <div class="grid-container" id="grid"></div>
    <div id="debug">디버그</div>

<script>
    const { abs, sign, floor, random } = Math;

    Q = (x, y=document) => y.querySelector(x);
    QQ = (x, y=document) => [...y.querySelectorAll(x)];

    range = (a, l=0, d=1) => [...Array(abs(l - a)/d)].map((_,i)=>l ? a*1 + d * i * sign(l - a) : d * i * sign(a));
    natural = (n, m=undefined) => m ? range(+n, (+m)+1) : range(1, (+n)+1);
    vector = (n, f=()=>0) => [...Array(n)].map((_,i)=>f(i,n));
    matrix = (rows, cols, f=()=>0) => vector(rows).map((_,i) => vector(cols).map((_,j) => f(i,j,rows,cols)));

    randz = (min, max, arr=0) => arr ? range(arr).map(x => randz(min,max)) : floor(random() *(max - min + 1)) + min;

    debug = (x) => Q('#debug').innerHTML = x;

    const container = document.getElementById('grid');
    const totalItems = 12;

    동물 = [0, '여우', '부엉이', '곰', '토끼', '돼지', '강아지',
              '고양이', '햄스터', '펭귄', '사자', '호랑이', '판다',
              '너구리', '다람쥐', '얼룩말', '고슴도치',
              '코끼리', '코알라', '캥거루', '원숭이'];
    주격 = [0, '는', '는', '은', '는', '는', '는',
              '는', '는', '은', '는', '는', '는',
              '는', '는', '은', '는',
              '는', '는', '는', '는']

    const animals = Array.from({ length: totalItems }, (_, i) => ({
      src: `assets/동물${i + 1}.png`,
      text: `${동물[s = randz(1, totalItems)]}${주격[s]} ${['구라를 치고 있습니다', '진실을 말하였습니다'][randz(0,100)%2]}`,
      // text: `일이삼사 오육칠 팔 구십 일 이삼사 오육칠팔구십 일이삼 사오육 칠팔구십`, // 텍스트 길이: 띄어쓰기 포함해서 33글자 내외
    }));

    for (let i = 0; i < animals.length; i++) {
      const animal = animals[i];

      const wrapper = document.createElement('div');
      wrapper.className = 'statement-container';

      const circle = document.createElement('div');
      circle.className = 'circle';

      const img = document.createElement('img');
      img.src = animal.src;
      img.alt = `동물${i + 1}`;
      circle.appendChild(img);

      const bubble = document.createElement('div');
      bubble.className = 'speech-bubble';
      bubble.textContent = animal.text;

      wrapper.appendChild(circle);
      wrapper.appendChild(bubble);
      container.appendChild(wrapper);
    }
  </script>
  <script>
    function getColumnCount() {
        const items = QQ('.statement-container');
        const rowTops = new Set();

        items.forEach(item => {
            rowTops.add(item.offsetTop);
        });

        const columnCount = items.length / rowTops.size;
        return Math.round(columnCount);
    }

    function updateLayoutBasedOnColumn() {
        QQ('.reverse').forEach(x => x.classList.remove('reverse'));

        const count = getColumnCount();
        const items = QQ('.statement-container').filter((_, i) => i % 2 === 1);

        if (count === 2)
            items.forEach(el => el.classList.add('reverse'));
    }

    // 초기 및 리사이즈 반응
    updateLayoutBasedOnColumn();
    window.addEventListener('resize', updateLayoutBasedOnColumn);

  </script>

</body>
</html>
