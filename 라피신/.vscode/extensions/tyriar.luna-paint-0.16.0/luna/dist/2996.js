"use strict";const a14_0x59f8=["_model","fill","ellipse","var(--luna-focusColor)","min","getCoordsFromEvent","shape","number","left","ceil","124721UAABmK","createDomRenderProgram","_edit","block","string-combo","toString","_viewportService","currentLayer","createReadonlyRgbaColor","path","version","register","createElementNS","pointerDownMove","viewportService","6469srPxaP","_svgPath","linearBurn","webpackChunkluna","strokeWidth","_onRequestRender","none","Brush Size","_value","_svgPath2","options","requestRender","softLight","fire","imageService","pow","string","_setPixel","position","exclusion","round","style","display","transparent","name","_brushSizeOption","1.1","onHistoryUpdateValue","Eraser","eraser","zoom","lighten","floor","render","svg","overlay","linearDodgeAdd","height","onUpdate","_onHistoryUpdateValue","triangle","setAttribute","getOutlineSvgPath","atan2","_imageService","29oXnOId","stroke","range","type","flipX","top","1314628etATdA","_updateOutline","event","absolute","darken","flipY","815889jCKKHP","rightTriangle","onRequestRender","113PowxyR","prepend","allowUnchecking","setValueFromHistoryChange","diamond","cos","clientHeight","multiply","_drawLine","width","selectionService","normal","removeChild","pointerUp","sqrt","_onUpdate","Blend Mode","_sc","drawCircle","abs","hasImage","screen","max","bind","containsCoord","pointerDown","value","2940008klcYov","then","_lastCoord","_container","11TvsODP","clientWidth","263aSKyoM","difference","boolean","_outlineModel","126397yHoVVz","_svg","_getEdit"],a14_0x95f1=function(t,s){return a14_0x59f8[t-=384]},a14_0x555f37=a14_0x95f1;!function(t,s){const e=a14_0x95f1;for(;;)try{if(708861===parseInt(e(449))*-parseInt(e(455))-parseInt(e(468))+parseInt(e(415))+parseInt(e(483))*-parseInt(e(403))+-parseInt(e(451))*parseInt(e(418))+-parseInt(e(409))+parseInt(e(445)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a14_0x59f8),(self[a14_0x555f37(486)]=self[a14_0x555f37(486)]||[]).push([[2996],{3315:(t,s,e)=>{const i=a14_0x555f37;e.d(s,{d:()=>c});var n=e(5120),h=e(1003),o=e(1674);let r,a;class c extends n.JT{constructor(t,s,e,i){const n=a14_0x95f1;super(),this[n(448)]=t,this._imageService=s,this[n(474)]=e,this[n(458)]=i,this.order=2,this[n(456)]=document.createElementNS(o.q,n(392)),this[n(456)].setAttribute(n(478),n(384)),this._svg[n(504)][n(501)]=n(412),this[n(484)]=document[n(480)](o.q,n(477)),this._svgPath[n(504)][n(404)]=n(461),this[n(484)][n(504)].fill=n(506),this._svgPath.style[n(487)]="1",this[n(492)]=document[n(480)](o.q,n(477)),this._svgPath2.style.stroke=n(461),this[n(492)].style[n(459)]=n(506),this[n(492)][n(504)].strokeWidth="1",this[n(456)].append(this[n(484)],this[n(492)]),this[n(448)][n(419)](this[n(456)]),this.register({dispose:()=>this[n(448)][n(430)](this[n(456)])})}async[i(391)](){const t=i,s=this[t(458)][t(405)],n=this._viewportService;if(!s)return void(this[t(456)][t(504)][t(505)]=t(489));if(this[t(456)][t(504)].display="block",!this[t(402)][t(475)])return;if(r!==this[t(458)][t(464)]){let s;switch(r=this._model[t(464)],r){case t(422):s=e.e(727)[t(446)](e[t(441)](e,727));break;case t(460):s=e.e(8459)[t(446)](e.bind(e,8459));break;case t(398):s=e.e(4012)[t(446)](e[t(441)](e,4012));break;case t(416):s=e.e(6243)[t(446)](e[t(441)](e,6243));break;default:s=void 0}a=s?new Promise((async t=>{t(new(await s).default)})):s}const o=await a,c=Math[t(503)](this[t(448)][t(450)]/2)-this[t(402)][t(427)]/2*n.zoom+n.x*n[t(388)],u=Math[t(503)](this._container[t(424)]/2)-this[t(402)][t(395)]/2*n[t(388)]+n.y*n[t(388)],l=(0,h.Oq)(s)*n[t(388)],d=(0,h.rY)(s)*n[t(388)];this[t(456)].style.left=c+s[t(466)]*n[t(388)]-2+"px",this[t(456)][t(504)][t(408)]=u+s[t(408)]*n[t(388)]-2+"px",this._svg[t(399)]("width",(l+5)[t(473)]()),this[t(456)][t(399)](t(395),(d+5)[t(473)]()),this._svgPath[t(399)]("d","M2.5 2.5 h"+l+" v"+d+" h"+-l+" v"+-d),o?.[t(400)]?(this[t(492)][t(504)].display=t(471),this[t(492)][t(399)]("d",o[t(400)](l,d,this[t(458)][t(407)],this[t(458)][t(414)]))):this._svgPath2.style[t(505)]="none"}}},9904:(t,s,e)=>{const i=a14_0x555f37;e.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>u,X5:()=>l,qv:()=>d});var n=e(1815),h=e(5120),o=e(2939);class r extends h.JT{constructor(t,s,e,i=!0){const h=a14_0x95f1;super(),this[h(507)]=t,this[h(438)]=s,this[h(491)]=e,this[h(420)]=i,this[h(406)]=h(453),this[h(397)]=this[h(479)](new n.v),this[h(385)]=this[h(397)][h(411)],this[h(433)]=this.register(new n.v),this[h(396)]=this[h(433)][h(411)]}get[i(444)](){return this._value}set[i(444)](t){const s=i;this[s(491)]=t,this[s(433)][s(496)](t)}[i(421)](t){const s=i;this[s(491)]=t,this[s(397)][s(496)](t)}}class a extends h.JT{constructor(t,s,e){const h=i;super(),this.name=t,this[h(493)]=s,this._value=e,this[h(406)]=h(499),this[h(397)]=this[h(479)](new n.v),this[h(385)]=this[h(397)].event,this._onUpdate=this[h(479)](new n.v),this[h(396)]=this[h(433)].event}get[i(444)](){return this[i(491)]}set[i(444)](t){const s=i;this._value=t,this[s(433)][s(496)](t)}setValueFromHistoryChange(t){const s=i;this[s(491)]=t,this[s(397)][s(496)](t)}}class c extends h.JT{constructor(t,s,e){const h=i;super(),this[h(507)]=t,this[h(493)]=s,this[h(491)]=e,this[h(406)]=h(472),this[h(397)]=this[h(479)](new n.v),this.onHistoryUpdateValue=this[h(397)].event,this[h(433)]=this[h(479)](new n.v),this[h(396)]=this[h(433)][h(411)]}get[i(444)](){return this[i(491)]}set[i(444)](t){const s=i;this[s(491)]=t,this._onUpdate[s(496)](t)}[i(421)](t){const s=i;this[s(491)]=t,this[s(397)][s(496)](t)}}class u extends a{constructor(){const t=i;super(t(434),[t(429),"replace",t(413),"multiply",t(485),t(389),t(439),t(394),t(393),"softLight",t(452),t(502)],t(429))}}class l extends h.JT{constructor(t,s,e,h){const o=i;super(),this[o(507)]=t,this[o(491)]=s,this[o(462)]=e,this[o(440)]=h,this[o(406)]=o(465),this[o(397)]=this[o(479)](new n.v),this[o(385)]=this[o(397)].event,this[o(433)]=this[o(479)](new n.v),this.onUpdate=this[o(433)].event}get value(){const t=i;return(0,o.u)(this[t(491)],this.max,this[t(462)])}set[i(444)](t){const s=i;this[s(491)]=t,this[s(433)].fire(t)}[i(421)](t){const s=i;this[s(491)]=t,this[s(397)][s(496)](t)}}class d extends l{constructor(t,s,e,n){const h=i;super(t,s,e,n),this[h(406)]=h(465)}get[i(444)](){const t=i;return(0,o.u)(this[t(491)],this[t(440)],this[t(462)])}set[i(444)](t){const s=i;this[s(491)]=Math.floor(t),this._onUpdate[s(496)](t)}}},2996:(t,s,e)=>{const i=a14_0x555f37;e.r(s),e.d(s,{default:()=>l});var n=e(1815),h=e(5120),o=e(3315),r=e(9904),a=e(1019);const c=e(8752).m4[i(476)](0,0,0,0);class u extends h.JT{constructor(t){const s=i;super(),this._sc=t,this.id=s(387),this[s(508)]=new r.qv(s(490),1,1,1e3),this[s(493)]=[this[s(508)]],this[s(454)]={range:void 0},this._onRequestRender=this[s(479)](new n.v),this[s(417)]=this._onRequestRender[s(411)]}[i(469)](t){const s=i;return new o.d(t,this[s(435)][s(497)],this[s(435)][s(482)],this[s(454)])}[i(443)](t){const s=i,e=this[s(435)].imageService;if(!e[s(475)])return;const n=this[s(435)][s(482)].getCoordsFromEvent(t);if(n){if(e[s(442)](n[0],n[1])){const t=this[s(457)]();this[s(500)](this[s(457)](),n[0],n[1],this[s(508)][s(444)],c),t.requestRender()}this[s(447)]=n}}pointerMove(t){const s=i;if(!this[s(435)].imageService[s(475)])return;const e=this[s(435)][s(482)][s(463)](t);this[s(410)](e)}_updateOutline(t){const s=i;if(this._sc[s(497)][s(475)]&&(this._outlineModel[s(405)]?.[s(466)]!==t[0]||this[s(454)][s(405)]?.[s(408)]!==t[1])){if(this[s(435)][s(497)].containsCoord(t[0],t[1])){const e=(this._brushSizeOption[s(444)]-1)/2;this[s(454)][s(405)]={left:t[0]-Math[s(390)](e),top:t[1]-Math[s(390)](e),right:t[0]+Math[s(467)](e)+1,bottom:t[1]+Math[s(467)](e)+1}}else this[s(454)][s(405)]=void 0;this[s(488)].fire()}}[i(481)](t){const s=i;if(!this[s(447)])return;const e=this[s(435)][s(497)];if(!e.currentLayer)return;const n=this._sc[s(482)].getCoordsFromEvent(t);(e[s(442)](n[0],n[1])||e[s(442)](this[s(447)][0],this[s(447)][1]))&&this[s(426)](this._lastCoord,n,c),this[s(447)]=n}async[i(431)](){const t=i;this[t(435)][t(497)][t(475)]&&(this[t(470)]?.commit(t(386)),this[t(470)]=void 0),this[t(447)]=void 0}[i(426)](t,s,e){const n=i,h=this[n(457)]();(0,a.j)(e,t[0],t[1],s[0],s[1],((t,s,e)=>this[n(500)](h,t,s,this._brushSizeOption.value,e)),!1),h[n(494)]()}[i(457)](){const t=i;if(!this[t(470)]&&(this[t(470)]=this._sc.imageService[t(475)]?.createExtendedEdit(),!this[t(470)]))throw new Error("Could not create extended edit");return this._edit}[i(500)](t,s,e,n,h){const o=i;this[o(435)][o(428)][o(442)](s,e)&&this[o(435)][o(497)][o(442)](s,e)&&t.drawCircle(s,e,n,!0,h)}}const l=u},1019:(t,s,e)=>{e.d(s,{X:()=>h,j:()=>o});var i=e(8752),n=e(9455);function h(t,s,e,i,h,o){const r=a14_0x95f1,a=(0,n.zz)(t,s,e,i),c=.5*o*h*Math.sin(a),u=.5*o*h*Math[r(423)](a);return[{x:t-c,y:s-u},{x:t+c,y:s+u},{x:e+c,y:i+u},{x:e-c,y:i-u}]}function o(t,s,e,i,n,h,o,d=1){o?function(t,s,e,i,n,h,o){const r=a14_0x95f1;o<1&&(t=l(t,o));const a=Math[r(437)](n-e)>Math[r(437)](i-s);let d=0;a&&(d=s,s=e,e=d,d=i,i=n,n=d),s>i&&(d=s,s=i,i=d,d=e,e=n,n=d);const f=i-s;let v=(n-e)/f;0===f&&(v=1);let p=Math[r(503)](s),_=e+v*(p-s),g=u(s+.5);const x=p,M=Math[r(390)](_);let m=c(_)*g;a?(h(M,x,l(t,u(_)*g)),m>0&&h(M+1,x,l(t,m))):(h(x,M,l(t,u(_)*g)),m>0&&h(x,M+1,l(t,m)));let w=_+v;p=Math.round(i),_=n+v*(p-i),g=c(i+.5);const y=p,b=Math[r(390)](_);if(m=c(_)*g,a?(h(b,y,l(t,u(_)*g)),m>0&&h(b+1,y,l(t,c(_)*g))):(h(y,b,l(t,u(_)*g)),m>0&&h(y,b+1,l(t,c(_)*g))),a)for(let s=x+1;s<y;s++)h(Math[r(390)](w),s,l(t,u(w))),m=c(w),m>0&&h(Math[r(390)](w)+1,s,l(t,m)),w+=v;else for(let s=x+1;s<y;s++)h(s,Math[r(390)](w),l(t,u(w))),m=c(w),m>0&&h(s,Math[r(390)](w)+1,l(t,m)),w+=v}(t,s,e,i,n,h,d):function(t,s,e,i,n,h,o){const c=a14_0x95f1;o<1&&(t=l(t,o)),Math[c(437)](n-e)<Math.abs(i-s)?s>i?r(t,i,n,s,e,h):r(t,s,e,i,n,h):e>n?a(t,i,n,s,e,h):a(t,s,e,i,n,h)}(t,s,e,i,n,h,d)}function r(t,s,e,i,n,h){const o=i-s;let r=n-e,a=1;r<0&&(a=-1,r=-r);let c=2*r-o,u=e;for(let e=s;e<=i;e++)h(e,u,t),c>0?(u+=a,c+=2*(r-o)):c+=2*r}function a(t,s,e,i,n,h){let o=i-s;const r=n-e;let a=1;o<0&&(a=-1,o=-o);let c=2*o-r,u=s;for(let s=e;s<=n;s++)h(u,s,t),c>0?(u+=a,c+=2*(o-r)):c+=2*o}function c(t){return t%1}function u(t){return 1-t%1}function l(t,s){const e=a14_0x95f1;if(void 0!==t)return i.m4[e(476)](t[0],t[1],t[2],Math.round(t[3]*s))}},1674:(t,s,e)=>{e.d(s,{q:()=>i});const i="http://www.w3.org/2000/svg"},9455:(t,s,e)=>{function i(t,s,e,i){return 180*n(t,s,e,i)/Math.PI}function n(t,s,e,i){let n=-Math[a14_0x95f1(401)](i-s,e-t);return-180===n&&(n=180),n}function h(t){return t*Math.PI/180}function o(t,s,e,i,n,h){const o=a14_0x95f1,r=Math[o(432)](Math[o(498)](t-e,2)+Math[o(498)](s-i,2)),a=Math.sqrt(Math[o(498)](e-n,2)+Math.pow(i-h,2)),c=Math[o(432)](Math[o(498)](n-t,2)+Math[o(498)](h-s,2)),u=(r+a+c)/2;return Math[o(432)](u*(u-r)*(u-a)*(u-c))}function r(t,s,e,i,n,h,r,a){return o(t,s,e,i,n,h)+o(e,i,n,h,r,a)+o(n,h,r,a,t,s)+o(r,a,t,s,e,i)}e.d(s,{AM:()=>i,zz:()=>n,Ht:()=>h,ku:()=>o,hu:()=>r})}}]);