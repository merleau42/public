"use strict";const a3_0x38a2=[" x ","499399ZRUXOL","pow","toRgba","abs","51676fuyNWf",'Invalid dimensions for image "',"left","rgba","rgba(","right","createReadonlyHslColor","19SLcvjC","moveTo","round","smoothing","color","height","targetImage","isInteger","data","rgb","createReadonlyHsvColor","webpackChunkluna","293196UyozOL","blendMode","buffer","getImageData","lineWidth","bottom","subarray","type","cos",'Images "',"The line can not be drawn outside of the selection and viewport",'": ',"createReadonlyRgbaColor","width","hsl","set","Could not attain 2d context","createReadonlyRgbColor",'Range "',"12399fdjwXa","ceil","max","toHsl","createRgbColor","top","beginPath","lineTo","update","createHslColor","createEmptyRgbColor","push","sin","2522855pQniln","createEmptyHsvColor","strokeStyle","SharedArrayBuffer",'" dimensions differ',"createRgbaColor",'" and "',"min","selection","273954KIoMmv","length","Unrecognized array type","pointB","1016173uzuhim","toHsv","replace","floor",'" dimensions are equal',"createEmptyRgbaColor","strokeWidth","1KLiuqi","toRgb"],a3_0x27b3=function(t,n){return a3_0x38a2[t-=463]},a3_0x5696d6=a3_0x27b3;!function(t,n){const o=a3_0x27b3;for(;;)try{if(529312===parseInt(o(532))*parseInt(o(525))+parseInt(o(507))+-parseInt(o(485))+parseInt(o(518))*parseInt(o(521))+parseInt(o(511))+parseInt(o(466))+-parseInt(o(498)))break;t.push(t.shift())}catch(n){t.push(t.shift())}}(a3_0x38a2),(self[a3_0x5696d6(465)]=self[a3_0x5696d6(465)]||[])[a3_0x5696d6(496)]([[51],{51:(t,n,o)=>{o.r(n),o.d(n,{run:()=>u});var r=o(371),a=o(517),e=o(587),i=o(939),c=o(3),s=o(742);const u=async(t,n,o)=>{const u=a3_0x27b3;return(0,s.ap)(o,u(538)),!o[u(535)]&&o.strokeWidth<=1?function(t){const n=a3_0x27b3,o=t.pointA,s=t.pointB;o.x=Math[n(534)](o.x),o.y=Math[n(534)](o.y),s.x=Math[n(534)](s.x),s.y=Math[n(534)](s.y);const u=t[n(538)][n(479)],h=t[n(538)].width,f=(0,c.tH)(o.x,o.y,s.x,s.y);if(f.left=(0,i.u)(Math[n(514)](f[n(527)]),u,0),f[n(530)]=(0,i.u)(Math[n(486)](f[n(530)]),u,0),f.top=(0,i.u)(Math[n(486)](f.top),h,0),f[n(471)]=(0,i.u)(Math[n(486)](f[n(471)]),h,0),t[n(506)]&&(t[n(506)].left>f[n(527)]&&(f[n(527)]=Math.min(t[n(506)][n(527)],f.right)),t.selection[n(530)]<f.right&&(f[n(530)]=Math[n(487)](t[n(506)][n(530)],f[n(527)])),t[n(506)][n(490)]>f[n(490)]&&(f.top=Math[n(505)](t.selection[n(490)],f[n(471)])),t[n(506)][n(471)]<f[n(471)]&&(f.bottom=Math[n(487)](t[n(506)].bottom,f[n(490)]))),f.left===f[n(530)]||f[n(490)]===f.bottom)throw new Error("The line can not be drawn outside of the selection and viewport");let l=(0,r.X$)(Math[n(487)]((0,c.Oq)(f),(0,c.rY)(f)),u*h*4,!0),M=new Uint8Array(new SharedArrayBuffer(4*l[n(508)])),d=new Uint8Array(new SharedArrayBuffer(4*l[n(508)])),b=0,x=0;(0,e.j)(t.color,o.x,o.y,s.x,s.y,((o,e,i)=>{const c=n;o<f.left||o>=f.right||e<f.top||e>=f.bottom||(b>=l[c(508)]&&(l=(0,r.Rs)(l),M=(0,r.Rs)(M),d=(0,r.Rs)(d)),x=4*(e*u+o),l[b]=x,(0,r.Yr)(M,4*b,t[c(538)][c(540)],x),"replace"===t[c(467)]?t[c(538)][c(540)][c(481)](i,x):(0,a.B)(t[c(467)],t[c(538)][c(540)],x,i,0),(0,r.Yr)(d,4*b++,t[c(538)].data,x))}),t.smoothing,t[n(517)]);const y=l[n(472)](0,b);return{undoData:{indexList:y,colorData:M.subarray(0,4*b)},redoData:{indexList:y,colorData:d[n(472)](0,4*b)},range:f}}(o):function(t,n){const o=a3_0x27b3,e=n.pointA,s=n[o(510)],u=n[o(538)][o(479)],h=n[o(538)][o(537)],f=(0,c.tH)(e.x+.5,e.y+.5,s.x+.5,s.y+.5);f[o(527)]=Math[o(514)](f[o(527)]),f.right=Math[o(486)](f[o(530)]),f[o(490)]=Math[o(514)](f[o(490)]),f.bottom=Math[o(486)](f[o(471)]);const l=Math[o(486)](n[o(517)]/2);if(f[o(527)]-=l,f[o(530)]+=l,f.top-=l,f[o(471)]+=l,f[o(527)]=(0,i.u)(Math[o(514)](f[o(527)]),u,0),f[o(530)]=(0,i.u)(Math.ceil(f[o(530)]),u,0),f.top=(0,i.u)(Math[o(486)](f[o(490)]),h,0),f[o(471)]=(0,i.u)(Math[o(486)](f[o(471)]),h,0),n[o(506)]&&(n[o(506)].left>f[o(527)]&&(f.left=Math.min(n[o(506)][o(527)],f.right)),n.selection[o(530)]<f[o(530)]&&(f[o(530)]=Math[o(487)](n[o(506)].right,f.left)),n[o(506)][o(490)]>f.top&&(f[o(490)]=Math.min(n.selection[o(490)],f[o(471)])),n[o(506)][o(471)]<f.bottom&&(f[o(471)]=Math[o(487)](n.selection[o(471)],f[o(490)]))),f[o(527)]===f[o(530)]||f[o(490)]===f.bottom)throw new Error(o(476));const M=(0,c.Oq)(f),d=(0,c.rY)(f),b=.5,x=.5,y=.5,p=.5,g=new OffscreenCanvas(M,d).getContext("2d");if(!g)throw new Error(o(482));g[o(500)]=o(529)+n[o(536)][0]+","+n[o(536)][1]+","+n[o(536)][2]+","+n[o(536)][3]/255+")",g[o(470)]=n.strokeWidth,g[o(491)](),n.smoothing||n[o(517)]%2!=0?(g[o(533)](e.x-f[o(527)]+b,e.y-f[o(490)]+x),g[o(492)](s.x-f.left+y,s.y-f[o(490)]+p)):(g.moveTo(Math.round(e.x-f[o(527)]+b),Math.round(e.y-f[o(490)]+x)),g[o(492)](Math[o(534)](s.x-f[o(527)]+y),Math[o(534)](s.y-f.top+p))),g.stroke();const w=g[o(469)](0,0,M,d),m=(0,r.X$)(u*h,u*h*4,!0),_=(0,r.X$)(u*h*2,Math[o(487)](u,h),!0);let A=0,R=0,v=0,C=0;if(n[o(535)])for(v=0;v<d;v++)for(R=0;R<M;R++)C=4*(v*M+R),w[o(540)][C+3]>0&&(_[2*A]=R,_[2*A+1]=v,m[A++]=4*((f[o(490)]+v)*u+f[o(527)]+R));else for(v=0;v<d;v++)for(R=0;R<M;R++)C=4*(v*M+R),w[o(540)][C+3]>n[o(536)][3]/2&&(w.data[C+3]=n[o(536)][3],_[2*A]=R,_[2*A+1]=v,m[A++]=4*((f[o(490)]+v)*u+f[o(527)]+R));const U=m[o(472)](0,A);t[o(493)](.25);const I=new Uint8Array(new SharedArrayBuffer(4*m[o(508)]));for(C=0;C<m[o(508)];C++)(0,r.Yr)(I,4*C,n[o(538)][o(540)],m[C]);if(t[o(493)](.5),n[o(467)]===o(513))for(C=0;C<U[o(508)];C++)(0,r.Yr)(n.targetImage[o(540)],U[C],w[o(540)],4*(_[2*C+1]*M+_[2*C]));else for(C=0;C<U[o(508)];C++)(0,a.B)(n[o(467)],n[o(538)][o(540)],U[C],w.data,4*(_[2*C+1]*M+_[2*C]));t.update(.75);const B=new Uint8Array(new SharedArrayBuffer(4*m[o(508)]));for(C=0;C<m[o(508)];C++)(0,r.Yr)(B,4*C,n[o(538)][o(540)],m[C]);return t.update(1),{undoData:{indexList:U,colorData:I},redoData:{indexList:U,colorData:B},range:f}}(n,o)}},742:(t,n,o)=>{o.d(n,{ap:()=>a,TO:()=>e,zg:()=>i});var r=o(3);function a(t,n){const o=a3_0x27b3,r=t[n];if(r.width<1||r[o(537)]<1)throw new Error(o(526)+n+o(477)+r.width+o(520)+r[o(537)])}function e(t,n,o){const r=a3_0x27b3,a=t[n],e=t[o];if(a[r(479)]===e.width&&a[r(537)]===e[r(537)])throw new Error(r(475)+n+r(504)+o+r(515))}function i(t,n,o){const a=a3_0x27b3,e=t[n];if(!(0,r.ur)(o,e))throw new Error(a(484)+n+'" '+(0,r.PW)(e)+" must be contained within "+(0,r.PW)(o))}},371:(t,n,o)=>{function r(t,n=2*t.length){const o=a3_0x27b3;let r;if(t instanceof Float32Array)r=new Float32Array(n);else if(t instanceof Uint8Array)r=new Uint8Array(n);else if(t instanceof Uint16Array)r=new Uint16Array(n);else{if(!(t instanceof Uint32Array))throw new Error(o(509));r=new Uint32Array(n)}return r[o(481)](t),r}function a(t,n,o=!1){const r=a3_0x27b3;return n<Math[r(522)](2,8)?o?new Uint8Array(new SharedArrayBuffer(t)):new Uint8Array(t):n<Math[r(522)](2,16)?o?new Uint16Array(new SharedArrayBuffer(2*t)):new Uint16Array(t):o?new Uint32Array(new SharedArrayBuffer(4*t)):new Uint32Array(t)}function e(t,n,o,r){t[n]=o[r],t[n+1]=o[r+1],t[n+2]=o[r+2],t[n+3]=o[r+3]}o.d(n,{Rs:()=>r,X$:()=>a,Yr:()=>e})},517:(t,n,o)=>{const r=a3_0x5696d6;o.d(n,{B:()=>s});var a=o(371);const e=new Float32Array(6);let i;const c={normal:(t,n)=>n,darken:(t,n)=>Math[r(505)](t,n),multiply:(t,n)=>t*n,linearBurn:(t,n)=>Math.max(t+n-1,0),lighten:(t,n)=>Math[r(487)](t,n),screen:(t,n)=>1-(1-t)*(1-n),linearDodgeAdd:(t,n)=>Math[r(505)](t+n,1),overlay:(t,n)=>t<.5?2*t*n:1-2*(1-t)*(1-n),softLight:(t,n)=>n<.5?2*t*n+t*t*(1-2*n):Math.sqrt(t)*(2*n-1)+2*t*(1-n),difference:(t,n)=>Math[r(524)](t-n),exclusion:(t,n)=>t+n-2*t*n};function s(t,n,o,s,h,f=n,l=o){const M=r;if("replace"!==t){if(e[0]=s[h+3]/255,0===e[0])return n[o]=f[l],n[o+1]=f[l+1],n[o+2]=f[l+2],void(n[o+3]=f[l+3]);if(e[1]=f[l+3]/255,0===e[1])return n[o]=s[h],n[o+1]=s[h+1],n[o+2]=s[h+2],void(n[o+3]=s[h+3]);i=c[t],e[3]=i(f[l]/255,s[h]/255),e[4]=i(f[l+1]/255,s[h+1]/255),e[5]=i(f[l+2]/255,s[h+2]/255),e[2]=e[0]+e[1]*(1-e[0]),n[o]=Math[M(534)](u(f[l]/255,e[1],s[h]/255,e[0],e[3])/e[2]*255),n[o+1]=Math[M(534)](u(f[l+1]/255,e[1],s[h+1]/255,e[0],e[4])/e[2]*255),n[o+2]=Math[M(534)](u(f[l+2]/255,e[1],s[h+2]/255,e[0],e[5])/e[2]*255),n[o+3]=Math[M(534)](255*e[2])}else(0,a.Yr)(n,o,s,h)}function u(t,n,o,r,a){return(n-n*r)*t+(r-n*r)*o+n*r*a}},587:(t,n,o)=>{o.d(n,{j:()=>s});var r,a,e,i,c=o(939);function s(t,n,o,r,a,e,i,c=1){i?function(t,n,o,r,a,e,i){const c=a3_0x27b3;i<1&&(t=M(t,i));const s=Math.abs(a-o)>Math.abs(r-n);let u=0;s&&(u=n,n=o,o=u,u=r,r=a,a=u),n>r&&(u=n,n=r,r=u,u=o,o=a,a=u);const h=r-n;let d=(a-o)/h;0===h&&(d=1);let b=Math.round(n),x=o+d*(b-n),y=l(n+.5);const p=b,g=Math[c(514)](x);let w=f(x)*y;s?(e(g,p,M(t,l(x)*y)),w>0&&e(g+1,p,M(t,w))):(e(p,g,M(t,l(x)*y)),w>0&&e(p,g+1,M(t,w)));let m=x+d;b=Math[c(534)](r),x=a+d*(b-r),y=f(r+.5);const _=b,A=Math[c(514)](x);if(w=f(x)*y,s?(e(A,_,M(t,l(x)*y)),w>0&&e(A+1,_,M(t,f(x)*y))):(e(_,A,M(t,l(x)*y)),w>0&&e(_,A+1,M(t,f(x)*y))),s)for(let n=p+1;n<_;n++)e(Math[c(514)](m),n,M(t,l(m))),w=f(m),w>0&&e(Math[c(514)](m)+1,n,M(t,w)),m+=d;else for(let n=p+1;n<_;n++)e(n,Math[c(514)](m),M(t,l(m))),w=f(m),w>0&&e(n,Math.floor(m)+1,M(t,w)),m+=d}(t,n,o,r,a,e,c):function(t,n,o,r,a,e,i){const c=a3_0x27b3;i<1&&(t=M(t,i)),Math[c(524)](a-o)<Math[c(524)](r-n)?n>r?u(t,r,a,n,o,e):u(t,n,o,r,a,e):o>a?h(t,r,a,n,o,e):h(t,n,o,r,a,e)}(t,n,o,r,a,e,c)}function u(t,n,o,r,a,e){const i=r-n;let c=a-o,s=1;c<0&&(s=-1,c=-c);let u=2*c-i,h=o;for(let o=n;o<=r;o++)e(o,h,t),u>0?(h+=s,u+=2*(c-i)):u+=2*c}function h(t,n,o,r,a,e){let i=r-n;const c=a-o;let s=1;i<0&&(s=-1,i=-i);let u=2*i-c,h=n;for(let n=o;n<=a;n++)e(h,n,t),u>0?(h+=s,u+=2*(i-c)):u+=2*i}function f(t){return t%1}function l(t){return 1-t%1}function M(t,n){const o=a3_0x27b3;if(void 0!==t)return a[o(478)](t[0],t[1],t[2],Math[o(534)](t[3]*n))}!function(t){const n=a3_0x27b3;function o(){const t=a3_0x27b3,n=new Float32Array(3);return n[t(473)]=t(463),n}function r(t,n,r){const a=o();return a[0]=t,a[1]=n,a[2]=r,a}t[n(495)]=o,t[n(489)]=r,t[n(483)]=function(t,n,o){return r(t,n,o)},t[n(512)]=function(t,o){const r=n,a=t[0]/255,e=t[1]/255,s=t[2]/255,u=Math[r(487)](a,e,s),h=u-Math[r(505)](a,e,s);let f;f=0===h?0:u===a?(e-s)/h%6:u===e?(s-a)/h+2:(a-e)/h+4,f=Math[r(534)](60*f),f<0&&(f+=360);const l=(0,c.s)(0===u?0:h/u,2),M=(0,c.s)(u,2);return void 0!==o&&(0===l||0===M)&&(f=o),i.createReadonlyHsvColor(f,l,M)},t[n(488)]=function(t){const o=n,r=e.createEmptyHslColor(),a=t[0]/255,i=t[1]/255,c=t[2]/255,s=Math[o(487)](a,i,c),u=Math[o(505)](a,i,c),h=s-u,f=(s+u)/2;return r[0]=0===h?0:s===a?(i-c)/h%6:s===i?(c-a)/h+2:(a-i)/h+4,r[0]=Math[o(534)](60*r[0]),r[0]<0&&(r[0]+=360),r[1]=0===h?0:h/(1-Math[o(524)](2*f-1)),r[2]=f,r},t[n(523)]=function(t,n){return a.createRgbaColor(t[0],t[1],t[2],n)}}(r||(r={})),function(t){const n=a3_0x27b3;function o(){const t=a3_0x27b3,n=new Float32Array(4);return n[t(473)]=t(528),n}function a(t,n,r,a=255){const e=o();return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}t.createEmptyRgbaColor=o,t[n(503)]=a,t[n(478)]=function(t,n,o,r=255){return a(t,n,o,r)},t[n(519)]=function(t){return r.createReadonlyRgbColor(t[0],t[1],t[2])}}(a||(a={})),function(t){const n=a3_0x27b3;function o(){const t=a3_0x27b3,n=new Float32Array(3);return n[t(473)]=t(480),n}function r(t,n,r){const a=o();return a[0]=t,a[1]=n,a[2]=r,a}t.createEmptyHslColor=o,t[n(494)]=r,t[n(531)]=function(t,n,o){return r(t,n,o)},t.toRgba=function(t,o=255){const r=n,e=a[r(516)]();e[3]=o;const i=(1-Math[r(524)](2*t[2]-1))*t[1],c=i*(1-Math[r(524)](t[0]/60%2-1)),s=t[2]-i/2;return t[0]<60?(e[0]=i,e[1]=c,e[2]=0):t[0]<120?(e[0]=c,e[1]=i,e[2]=0):t[0]<180?(e[0]=0,e[1]=i,e[2]=c):t[0]<240?(e[0]=0,e[1]=c,e[2]=i):t[0]<300?(e[0]=c,e[1]=0,e[2]=i):(e[0]=i,e[1]=0,e[2]=c),e[0]=Math.round(255*(e[0]+s)),e[1]=Math[r(534)](255*(e[1]+s)),e[2]=Math.round(255*(e[2]+s)),e}}(e||(e={})),function(t){const n=a3_0x27b3;function o(){const t=a3_0x27b3,n=new Float32Array(3);return n[t(473)]="hsv",n}function e(t,n,r){const a=o();return a[0]=t,a[1]=n,a[2]=r,a}function i(t){const o=n,a=r[o(495)](),e=t[2]*t[1],i=e*(1-Math[o(524)](t[0]/60%2-1)),c=t[2]-e;return t[0]<60?(a[0]=e,a[1]=i,a[2]=0):t[0]<120?(a[0]=i,a[1]=e,a[2]=0):t[0]<180?(a[0]=0,a[1]=e,a[2]=i):t[0]<240?(a[0]=0,a[1]=i,a[2]=e):t[0]<300?(a[0]=i,a[1]=0,a[2]=e):(a[0]=e,a[1]=0,a[2]=i),a[0]=Math.round(255*(a[0]+c)),a[1]=Math[o(534)](255*(a[1]+c)),a[2]=Math.round(255*(a[2]+c)),a}t[n(499)]=o,t.createHsvColor=e,t[n(464)]=function(t,n,o){return e(t,n,o)},t[n(519)]=i,t[n(523)]=function(t,n=255){const o=i(t);return a.createRgbaColor(o[0],o[1],o[2],(0,c.u)(n,255,0))}}(i||(i={}))},939:(t,n,o)=>{function r(t,n,o=0){const r=a3_0x27b3;return Math.max(Math[r(505)](t,n),o)}function a(t,n){const o=a3_0x27b3,r=Math[o(522)](10,n);return Math[o(534)](t*r)/r}o.d(n,{u:()=>r,s:()=>a})},3:(t,n,o)=>{function r(t){const n=a3_0x27b3;if(t)return{left:t[n(527)],top:t[n(490)],right:t.right,bottom:t.bottom}}function a(t,n){return{left:t,top:n,right:t+1,bottom:n+1}}function e(t,n){return{left:0,top:0,right:t,bottom:n}}function i(t,n,o,r){const a=a3_0x27b3,e=function(t){const n=a3_0x27b3;if(t.left>t.right){const o=t[n(530)];t[n(530)]=t.left,t[n(527)]=o}if(t.top>t[n(471)]){const o=t.bottom;t[n(471)]=t[n(490)],t[n(490)]=o}if(t[n(530)]<t.left){const o=t[n(527)];t[n(527)]=t[n(530)],t[n(530)]=o}if(t[n(471)]<t[n(490)]){const o=t[n(490)];t[n(490)]=t.bottom,t[n(471)]=o}return t}({left:t,top:n,right:o,bottom:r});return e[a(530)]++,e[a(471)]++,e}function c(t,n){const o=a3_0x27b3;return t[o(527)]=Math.min(Math.max(t[o(527)],n[o(527)]),n.right),t[o(490)]=Math[o(505)](Math[o(487)](t[o(490)],n[o(490)]),n.bottom),t[o(530)]=Math[o(487)](Math[o(505)](t[o(530)],n[o(530)]),n[o(527)]),t[o(471)]=Math[o(487)](Math[o(505)](t[o(471)],n[o(471)]),n[o(490)]),t}function s(t){const n=a3_0x27b3;return t[n(527)]=Math[n(514)](t[n(527)]),t[n(530)]=Math.ceil(t[n(530)]),t.top=Math[n(514)](t[n(490)]),t[n(471)]=Math.ceil(t[n(471)]),t}function u(t,n,o){const r=a3_0x27b3;if(function(t){const n=a3_0x27b3;return t[n(527)]===t[n(530)]||t.top===t[n(471)]}(t))return t.left=n,t[r(530)]=n+1,t[r(490)]=o,void(t[r(471)]=o+1);t.left=Math.min(t[r(527)],n),t[r(490)]=Math[r(505)](t[r(490)],o),t[r(530)]=Math[r(487)](t[r(530)],n+1),t[r(471)]=Math[r(487)](t[r(471)],o+1)}function h(t,n,o){const r=a3_0x27b3;return n>=t[r(527)]&&n<t[r(530)]&&o>=t[r(490)]&&o<t[r(471)]}function f(t,n){const o=a3_0x27b3;return n[o(527)]>=t[o(527)]&&n[o(530)]<=t.right&&n.top>=t[o(490)]&&n[o(471)]<=t[o(471)]}function l(t){const n=a3_0x27b3;return"("+t[n(527)]+","+t.top+")->("+t[n(530)]+","+t.bottom+")"}function M(t){const n=a3_0x27b3;return t[n(530)]-t[n(527)]}function d(t){return t[a3_0x27b3(471)]-t.top}o.d(n,{BN:()=>r,Re:()=>a,DI:()=>e,tH:()=>i,l$:()=>c,kq:()=>s,Hv:()=>u,RB:()=>h,ur:()=>f,PW:()=>l,Oq:()=>M,rY:()=>d})}}]);