"use strict";const a20_0x15c2=["clientHeight","fire","27367NtndzS","setValueFromHistoryChange","getColorFromPointerEvent","_updateCursorInfo","isVisible","round","_blendModeOption","exclusion","historyService","Blend Mode","pop","stroke","cursor-info","register","_onUpdate","cos","_outlineModel","101851zjxbHZ","_hideCursorInfo","linearDodgeAdd","max","commit","removeChild","webpackChunkluna","transparent","clientWidth","_ignoreSetPixel","prepend","operationName","hasImage","43ykfiwy","10DqxdOW","_getAngle","left","none","allowUnchecking","strokeWidth","_onHistoryUpdateValue","block","toString","event","currentLayer","_lastDownCoord","appendChild","overlay","134121FHVANr","_setPixel","onRedo","_svg","_viewportService","pointerDownMove","3929HIRIdc","14391ELNgHd","_model","floor","screen","Pencil","shiftKey","_element","sin","viewportService","_value","sqrt","requestRender","offsetY","text","onHistoryUpdateValue","_container","_updateOutline","lighten","string-combo","push","_isShiftDown","append","l0 ","setAttribute","style","length","_getEdit","type","difference","_lastUpCoords","zoom","pointerUp","http://www.w3.org/2000/svg","value","render","_imageService","onUndo","pointerDown","onUpdate","createElementNS","replace","_onRequestRender","_color","1YJMcuL","activeEntry","height","selectionService","options","keyDown","_cursorCoord","linearBurn","imageService","getCoordsFromEvent","3wBMfAO","pow","display","multiply","setPixel","containsCoord","boolean","createDomRenderProgram","isValid","6yFNZeL","_drawLine","width","pointerMove","_sc","createElement","1214638CMobPo","offsetX","_edit","darken","298798qijETj","_svgPath","name","min","path","number","keyUp","join","normal","forceSolid","_cursorInfo","abs"],a20_0x5448=function(t,s){return a20_0x15c2[t-=216]},a20_0x6cb030=a20_0x5448;!function(t,s){const i=a20_0x5448;for(;;)try{if(738787===parseInt(i(222))*-parseInt(i(236))+-parseInt(i(319))*-parseInt(i(250))+parseInt(i(256))+parseInt(i(343))*-parseInt(i(235))+parseInt(i(257))+-parseInt(i(310))*-parseInt(i(329))+-parseInt(i(300))*-parseInt(i(325)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a20_0x15c2),(self.webpackChunkluna=self[a20_0x6cb030(228)]||[]).push([[5525],{7571:(t,s,i)=>{const e=a20_0x6cb030;i.d(s,{P:()=>o});var h=i(5120);class o extends h.JT{constructor(t,s){const i=a20_0x5448;super(),this[i(272)]=t,this[i(258)]=s,this.order=2,this._element=document[i(324)]("div"),this[i(263)].classList.add(i(217)),this[i(272)][i(248)](this[i(263)]),this.register({dispose:()=>this[i(272)][i(227)](this[i(263)])})}[e(291)](){const t=e;this[t(263)].style[t(312)]=this[t(258)][t(347)]?t(243):t(239),this[t(263)][t(281)][t(238)]=this[t(258)].x+"px",this._element[t(281)].top=this[t(258)].y+"px",this[t(263)].textContent=this[t(258)][t(270)]}}},566:(t,s,i)=>{i.d(s,{d:()=>n,I:()=>r});var e=i(1019),h=i(5120),o=i(1674);class n extends h.JT{constructor(t,s,i,e){const h=a20_0x5448;super(),this[h(272)]=t,this[h(292)]=s,this._viewportService=i,this._model=e,this.order=2,this[h(253)]=document[h(296)](o.q,"svg"),this._svgPath=document[h(296)](o.q,h(333)),this[h(330)].style[h(216)]="var(--luna-focusColor)",this._svgPath[h(281)].fill=h(229),this[h(330)].style[h(241)]="1",this[h(253)][h(278)](this._svgPath),this[h(272)][h(232)](this[h(253)]),this.register({dispose:()=>this[h(272)][h(227)](this[h(253)])})}render(){const t=a20_0x5448,s=this[t(254)];if(!this._model.isValid||!this[t(292)][t(246)])return void(this[t(253)][t(281)][t(312)]=t(239));if(this._svg[t(281)].display=t(243),!this[t(258)][t(338)]&&this[t(258)][t(241)]<=1&&s[t(287)]>=3){const i=[];(0,e.j)(void 0,this[t(258)].x1,this[t(258)].y1,this._model.x2,this[t(258)].y2,((t,s)=>i.push([t,s])),!1,this[t(258)][t(241)]);const h=[];let o=0;for(;o<i[t(282)]-1;o++){const s=i[o];let e=o;if(s[0]===i[e+1][0]){for(;e+1<i.length&&s[0]===i[e+1][0];)e++;h[t(276)]([s[0],s[1],1,e-o+1])}else if(s[1]===i[e+1][1]){for(;e+1<i[t(282)]&&s[1]===i[e+1][1];)e++;h[t(276)]([s[0],s[1],e-o+1,1])}else h[t(276)]([s[0],s[1],1,1]);o=e}o===i[t(282)]-1&&h[t(276)]([i[o][0],i[o][1],1,1]);const n=Math.round(this._container[t(230)]/2)-this[t(292)][t(321)]/2*s.zoom+s.x*s.zoom,r=Math[t(348)](this._container[t(341)]/2)-this._imageService[t(302)]/2*s[t(287)]+s.y*s[t(287)];let c="";for(const i of h)c+="M"+(n+i[0]*s.zoom)+" "+(r+i[1]*s[t(287)]),c+="l"+i[2]*s[t(287)]+" 0",c+=t(279)+i[3]*s.zoom,c+="l-"+i[2]*s.zoom+" 0z";return this._svg[t(280)](t(321),this[t(272)].clientWidth[t(244)]()),this[t(253)][t(280)]("height",this[t(272)][t(341)][t(244)]()),void this[t(330)].setAttribute("d",c)}this[t(253)].style.display=t(243);const i=Math.round(this._container[t(230)]/2)-this[t(292)].width/2*s[t(287)]+s.x*s[t(287)],h=Math[t(348)](this[t(272)][t(341)]/2)-this[t(292)][t(302)]/2*s.zoom+s.y*s[t(287)],o=i+(this[t(258)].x1+.5)*s.zoom,n=h+(this[t(258)].y1+.5)*s.zoom,r=i+(this[t(258)].x2+.5)*s[t(287)],c=h+(this._model.y2+.5)*s[t(287)];if(this[t(253)][t(280)](t(321),this[t(272)][t(230)][t(244)]()),this[t(253)][t(280)](t(302),this._container[t(341)][t(244)]()),s[t(287)]>=3){const i=(0,e.X)(o,n,r,c,this._model[t(241)],s[t(287)]);this._svgPath.setAttribute("d","M"+i.map((t=>t.x+","+t.y))[t(336)](" L")+"z")}else this._svgPath.setAttribute("d","M"+o+","+n+" L"+r+","+c)}}class r{constructor(){const t=a20_0x5448;this[t(318)]=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this[t(241)]=1,this[t(338)]=!1}}},9904:(t,s,i)=>{const e=a20_0x6cb030;i.d(s,{FV:()=>r,rP:()=>c,tv:()=>a,Jp:()=>l,X5:()=>u,qv:()=>d});var h=i(1815),o=i(5120),n=i(2939);class r extends o.JT{constructor(t,s,i,e=!0){const o=a20_0x5448;super(),this.name=t,this[o(234)]=s,this._value=i,this[o(240)]=e,this.type=o(316),this[o(242)]=this.register(new h.v),this[o(271)]=this[o(242)][o(245)],this._onUpdate=this[o(218)](new h.v),this[o(295)]=this._onUpdate[o(245)]}get[e(290)](){return this._value}set[e(290)](t){const s=e;this[s(266)]=t,this[s(219)][s(342)](t)}[e(344)](t){const s=e;this._value=t,this[s(242)][s(342)](t)}}class c extends o.JT{constructor(t,s,i){const o=e;super(),this[o(331)]=t,this.options=s,this[o(266)]=i,this.type="string",this[o(242)]=this.register(new h.v),this[o(271)]=this[o(242)][o(245)],this[o(219)]=this[o(218)](new h.v),this[o(295)]=this[o(219)][o(245)]}get[e(290)](){return this[e(266)]}set[e(290)](t){const s=e;this[s(266)]=t,this[s(219)][s(342)](t)}[e(344)](t){const s=e;this[s(266)]=t,this[s(242)][s(342)](t)}}class a extends o.JT{constructor(t,s,i){const o=e;super(),this[o(331)]=t,this[o(304)]=s,this[o(266)]=i,this[o(284)]=o(275),this[o(242)]=this[o(218)](new h.v),this.onHistoryUpdateValue=this[o(242)][o(245)],this[o(219)]=this[o(218)](new h.v),this[o(295)]=this[o(219)][o(245)]}get[e(290)](){return this[e(266)]}set[e(290)](t){const s=e;this[s(266)]=t,this._onUpdate[s(342)](t)}[e(344)](t){const s=e;this._value=t,this[s(242)].fire(t)}}class l extends c{constructor(){const t=e;super("Blend Mode",[t(337),t(297),t(328),t(313),t(307),t(274),t(260),t(224),"overlay","softLight","difference","exclusion"],"normal")}}class u extends o.JT{constructor(t,s,i,o){const n=e;super(),this[n(331)]=t,this._value=s,this[n(332)]=i,this[n(225)]=o,this[n(284)]=n(334),this[n(242)]=this[n(218)](new h.v),this[n(271)]=this[n(242)][n(245)],this[n(219)]=this[n(218)](new h.v),this[n(295)]=this._onUpdate[n(245)]}get value(){const t=e;return(0,n.u)(this[t(266)],this[t(225)],this[t(332)])}set[e(290)](t){const s=e;this[s(266)]=t,this[s(219)].fire(t)}setValueFromHistoryChange(t){const s=e;this._value=t,this[s(242)][s(342)](t)}}class d extends u{constructor(t,s,i,e){super(t,s,i,e),this.type="number"}get[e(290)](){const t=e;return(0,n.u)(this._value,this[t(225)],this[t(332)])}set[e(290)](t){const s=e;this._value=Math[s(259)](t),this[s(219)].fire(t)}}},5525:(t,s,i)=>{const e=a20_0x6cb030;i.r(s),i.d(s,{default:()=>d});var h=i(1815),o=i(5120),n=i(9455),r=i(7571),c=i(566),a=i(9904),l=i(1019);class u extends o.JT{constructor(t){const s=a20_0x5448;super(),this[s(323)]=t,this.id="pencil",this[s(286)]=[],this._cursorCoord=[0,0],this[s(277)]=!1,this._outlineModel=new c.I,this[s(349)]=new a.Jp,this[s(304)]=[this[s(349)]],this._onRequestRender=this.register(new h.v),this.onRequestRender=this._onRequestRender[s(245)],this[s(339)]={x:0,y:0,text:"",isVisible:!1},this[s(218)](this._sc[s(351)][s(293)]((t=>{const i=s;t[i(233)]===i(261)&&this[i(323)][i(351)][i(301)]?.operationName===i(261)?this[i(286)]?.[i(353)]():this._lastUpCoords[i(282)]=0}))),this[s(218)](this[s(323)][s(351)][s(252)]((()=>this[s(286)].length=0))),this._sc[s(265)][s(295)]((()=>{const t=s;this[t(221)][t(318)]=!1,this[t(223)]()}))}[e(317)](t){const s=e;return[new r.P(t,this[s(339)]),new c.d(t,this[s(323)][s(308)],this[s(323)][s(265)],this[s(221)])]}[e(294)](t){const s=e,i=this[s(323)][s(308)];if(!i[s(246)])return;if(this[s(299)]=this[s(323)].paletteService[s(345)](t),!this._color)return;const h=this._sc[s(265)][s(309)](t);if(h){if(t[s(262)]&&this._lastUpCoords[s(282)]>0){const t=this[s(286)][this[s(286)].length-1];this[s(231)]=t,this[s(320)](t,h,this[s(299)]),this[s(231)]=void 0}if(i.containsCoord(h[0],h[1])){const t=this._getEdit();this[s(251)](this._getEdit(),h[0],h[1],this[s(299)]),t[s(268)]()}this[s(247)]=h}}[e(255)](t){const s=e;if(!this[s(247)]||!this._color)return;const i=this[s(323)][s(308)];if(!i[s(246)])return;const h=this[s(323)][s(265)].getCoordsFromEvent(t);this[s(247)][0]===h[0]&&this[s(247)][1]===h[1]||((i.containsCoord(h[0],h[1])||i[s(315)](this[s(247)][0],this._lastDownCoord[1]))&&this[s(320)](this[s(247)],h,this[s(299)]),this[s(247)]=h)}async[e(288)](t){const s=e;this[s(323)][s(308)][s(246)]&&(this[s(327)]?.[s(226)](s(261)),this[s(327)]=void 0);const i=this[s(323)][s(265)][s(309)](t);this[s(286)][s(276)](i),this._updateOutline(t,!1,!0)}async[e(322)](t,s){const i=e;this[i(339)].x=t[i(326)],this[i(339)].y=t[i(269)],this._cursorCoord=this[i(323)].viewportService[i(309)](t),this[i(273)](t,s),!s&&t[i(262)]?this[i(346)]():this[i(339)][i(347)]&&this._hideCursorInfo()}[e(305)](t,s){const i=e;!this[i(277)]&&t.shiftKey&&(this[i(277)]=!0,!s&&(this[i(346)](),this[i(273)](t,s,!0)))}[e(335)](t){const s=e;!t[s(262)]&&(this[s(221)].isValid=!1,this[s(298)][s(342)](),this._cursorInfo[s(347)]&&this[s(223)](),this[s(277)]=!1)}[e(273)](t,s,i){const h=e;if(i||this[h(221)].x1!==this[h(306)][0]||this._outlineModel.y1!==this[h(306)][1]){if(this._outlineModel.x1=this[h(306)][0],this._outlineModel.y1=this[h(306)][1],!s&&t[h(262)]&&this[h(286)].length>0){const t=this[h(286)][this[h(286)][h(282)]-1];this[h(221)].x2=t[0],this[h(221)].y2=t[1],this._outlineModel[h(318)]=!0}else this[h(221)].x2=this._cursorCoord[0],this[h(221)].y2=this[h(306)][1],this[h(221)][h(318)]=this[h(323)][h(308)].containsCoord(this._outlineModel.x1,this[h(221)].y1);this[h(298)][h(342)]()}}[e(346)](){const t=e;if(0===this._lastUpCoords[t(282)])return;if(!this._cursorCoord)return;const s=this[t(286)][this[t(286)].length-1];if(s[0]===this[t(306)][0]&&s[1]===this[t(306)][1])return;const i=this[t(237)](s,this[t(306)]);this._cursorInfo[t(270)]=i+"°",this[t(339)][t(347)]=!0,this[t(298)][t(342)]()}[e(237)](t,s){return Math[e(348)](10*(0,n.AM)(t[0],t[1],s[0],s[1]))/10}_hideCursorInfo(){const t=e;this._cursorInfo[t(347)]=!1,this[t(298)].fire()}[e(320)](t,s,i){const h=e,o=this[h(283)]();(0,l.j)(i,t[0],t[1],s[0],s[1],((t,s,i)=>this[h(251)](o,t,s,i)),!1),o[h(268)]()}_getEdit(){const t=e;if(!this[t(327)]&&(this[t(327)]=this._sc[t(308)][t(246)]?.createExtendedEdit(),!this._edit))throw new Error("Could not create extended edit");return this[t(327)]}[e(251)](t,s,i,h){const o=e;this._ignoreSetPixel&&this[o(231)][0]===s&&this._ignoreSetPixel[1]===i||this[o(323)][o(303)][o(315)](s,i)&&this[o(323)][o(308)][o(315)](s,i)&&t[o(314)](s,i,h,this[o(349)].value===o(297)?void 0:this[o(349)].value)}}const d=u},1019:(t,s,i)=>{i.d(s,{X:()=>o,j:()=>n});var e=i(8752),h=i(9455);function o(t,s,i,e,o,n){const r=a20_0x5448,c=(0,h.zz)(t,s,i,e),a=.5*n*o*Math[r(264)](c),l=.5*n*o*Math[r(220)](c);return[{x:t-a,y:s-l},{x:t+a,y:s+l},{x:i+a,y:e+l},{x:i-a,y:e-l}]}function n(t,s,i,e,h,o,n,d=1){n?function(t,s,i,e,h,o,n){const r=a20_0x5448;n<1&&(t=u(t,n));const c=Math.abs(h-i)>Math.abs(e-s);let d=0;c&&(d=s,s=i,i=d,d=e,e=h,h=d),s>e&&(d=s,s=e,e=d,d=i,i=h,h=d);const _=e-s;let p=(h-i)/_;0===_&&(p=1);let f=Math.round(s),v=i+p*(f-s),x=l(s+.5);const g=f,y=Math.floor(v);let M=a(v)*x;c?(o(y,g,u(t,l(v)*x)),M>0&&o(y+1,g,u(t,M))):(o(g,y,u(t,l(v)*x)),M>0&&o(g,y+1,u(t,M)));let m=v+p;f=Math[r(348)](e),v=h+p*(f-e),x=a(e+.5);const w=f,C=Math[r(259)](v);if(M=a(v)*x,c?(o(C,w,u(t,l(v)*x)),M>0&&o(C+1,w,u(t,a(v)*x))):(o(w,C,u(t,l(v)*x)),M>0&&o(w,C+1,u(t,a(v)*x))),c)for(let s=g+1;s<w;s++)o(Math.floor(m),s,u(t,l(m))),M=a(m),M>0&&o(Math[r(259)](m)+1,s,u(t,M)),m+=p;else for(let s=g+1;s<w;s++)o(s,Math[r(259)](m),u(t,l(m))),M=a(m),M>0&&o(s,Math.floor(m)+1,u(t,M)),m+=p}(t,s,i,e,h,o,d):function(t,s,i,e,h,o,n){const a=a20_0x5448;n<1&&(t=u(t,n)),Math.abs(h-i)<Math[a(340)](e-s)?s>e?r(t,e,h,s,i,o):r(t,s,i,e,h,o):i>h?c(t,e,h,s,i,o):c(t,s,i,e,h,o)}(t,s,i,e,h,o,d)}function r(t,s,i,e,h,o){const n=e-s;let r=h-i,c=1;r<0&&(c=-1,r=-r);let a=2*r-n,l=i;for(let i=s;i<=e;i++)o(i,l,t),a>0?(l+=c,a+=2*(r-n)):a+=2*r}function c(t,s,i,e,h,o){let n=e-s;const r=h-i;let c=1;n<0&&(c=-1,n=-n);let a=2*n-r,l=s;for(let s=i;s<=h;s++)o(l,s,t),a>0?(l+=c,a+=2*(n-r)):a+=2*n}function a(t){return t%1}function l(t){return 1-t%1}function u(t,s){const i=a20_0x5448;if(void 0!==t)return e.m4.createReadonlyRgbaColor(t[0],t[1],t[2],Math[i(348)](t[3]*s))}},1674:(t,s,i)=>{const e=a20_0x6cb030;i.d(s,{q:()=>h});const h=e(289)},9455:(t,s,i)=>{function e(t,s,i,e){return 180*h(t,s,i,e)/Math.PI}function h(t,s,i,e){let h=-Math.atan2(e-s,i-t);return-180===h&&(h=180),h}function o(t){return t*Math.PI/180}function n(t,s,i,e,h,o){const n=a20_0x5448,r=Math.sqrt(Math[n(311)](t-i,2)+Math[n(311)](s-e,2)),c=Math.sqrt(Math[n(311)](i-h,2)+Math[n(311)](e-o,2)),a=Math[n(267)](Math[n(311)](h-t,2)+Math[n(311)](o-s,2)),l=(r+c+a)/2;return Math[n(267)](l*(l-r)*(l-c)*(l-a))}function r(t,s,i,e,h,o,r,c){return n(t,s,i,e,h,o)+n(i,e,h,o,r,c)+n(h,o,r,c,t,s)+n(r,c,t,s,i,e)}i.d(s,{AM:()=>e,zz:()=>h,Ht:()=>o,ku:()=>n,hu:()=>r})}}]);