"use strict";const a52_0x5e97=["moveTo","pointA","strokeStyle","12039VPiZjV","min","49667cgvcal","height","replace","stroke","targetImage",'Images "',"max","getContext","color",'" dimensions are equal',"844376UAtvtt","Could not attain 2d context","webpackChunkluna","335365nKbJnX","length","613714lTFEoD","abs","rgba(",'" and "',"pointB","getImageData","blendMode","pow","floor","1334391NNwoki",'": ',"top","8qFCFzk","round","sin","selection","3FUddJZ","962630mEMdIC","24yDhkHl",'Range "','" dimensions differ',"ceil","1qQbhPo","width",'Invalid dimensions for image "',"beginPath","atan2","bottom","smoothing","The line can not be drawn outside of the selection and viewport","strokeWidth","data","sqrt","subarray"," x ","right","left","update","lineTo"],a52_0x5689=function(t,a){return a52_0x5e97[t-=313]},a52_0x450650=a52_0x5689;!function(t,a){const n=a52_0x5689;for(;;)try{if(924762===parseInt(n(320))+parseInt(n(327))*parseInt(n(370))+-parseInt(n(328))+parseInt(n(329))*parseInt(n(353))+-parseInt(n(365))+-parseInt(n(333))*parseInt(n(368))+parseInt(n(355))*-parseInt(n(323)))break;t.push(t.shift())}catch(a){t.push(t.shift())}}(a52_0x5e97),(self[a52_0x450650(367)]=self[a52_0x450650(367)]||[]).push([[6051],{6051:(t,a,n)=>{n.r(a),n.d(a,{run:()=>c});var o=n(4371),e=n(7517),r=n(1019),h=n(2939),i=n(1003),s=n(7742);const c=async(t,a,n)=>{const c=a52_0x5689;return(0,s.ap)(n,c(359)),!n[c(339)]&&n.strokeWidth<=1?function(t){const a=a52_0x5689,n=t[a(351)],s=t[a(315)];n.x=Math[a(324)](n.x),n.y=Math[a(324)](n.y),s.x=Math.round(s.x),s.y=Math[a(324)](s.y);const c=t[a(359)][a(334)],f=t.targetImage[a(334)],u=(0,i.tH)(n.x,n.y,s.x,s.y);if(u[a(347)]=(0,h.u)(Math.floor(u[a(347)]),c,0),u[a(346)]=(0,h.u)(Math[a(332)](u[a(346)]),c,0),u[a(322)]=(0,h.u)(Math.ceil(u[a(322)]),f,0),u[a(338)]=(0,h.u)(Math[a(332)](u[a(338)]),f,0),t[a(326)]&&(t.selection[a(347)]>u[a(347)]&&(u[a(347)]=Math[a(354)](t[a(326)][a(347)],u[a(346)])),t[a(326)][a(346)]<u[a(346)]&&(u[a(346)]=Math[a(361)](t[a(326)].right,u[a(347)])),t[a(326)][a(322)]>u[a(322)]&&(u.top=Math[a(354)](t[a(326)][a(322)],u[a(338)])),t.selection[a(338)]<u[a(338)]&&(u[a(338)]=Math[a(361)](t[a(326)][a(338)],u[a(322)]))),u.left===u[a(346)]||u.top===u.bottom)throw new Error("The line can not be drawn outside of the selection and viewport");let l=(0,o.X$)(Math[a(361)]((0,i.Oq)(u),(0,i.rY)(u)),c*f*4,!0),M=new Uint8Array(new SharedArrayBuffer(4*l.length)),d=new Uint8Array(new SharedArrayBuffer(4*l.length)),x=0,p=0;(0,r.j)(t[a(363)],n.x,n.y,s.x,s.y,((n,r,h)=>{const i=a;n<u.left||n>=u[i(346)]||r<u[i(322)]||r>=u.bottom||(x>=l[i(369)]&&(l=(0,o.Rs)(l),M=(0,o.Rs)(M),d=(0,o.Rs)(d)),p=4*(r*c+n),l[x]=p,(0,o.Yr)(M,4*x,t[i(359)][i(342)],p),t.blendMode===i(357)?t[i(359)][i(342)].set(h,p):(0,e.B)(t[i(317)],t[i(359)].data,p,h,0),(0,o.Yr)(d,4*x++,t[i(359)][i(342)],p))}),t.smoothing,t.strokeWidth);const g=l.subarray(0,x);return{undoData:{indexList:g,colorData:M[a(344)](0,4*x)},redoData:{indexList:g,colorData:d[a(344)](0,4*x)},range:u}}(n):function(t,a){const n=a52_0x5689,r=a.pointA,s=a[n(315)],c=a.targetImage.width,f=a.targetImage[n(356)],u=(0,i.tH)(r.x+.5,r.y+.5,s.x+.5,s.y+.5);u.left=Math[n(319)](u[n(347)]),u[n(346)]=Math[n(332)](u[n(346)]),u.top=Math[n(319)](u[n(322)]),u[n(338)]=Math[n(332)](u.bottom);const l=Math[n(332)](a[n(341)]/2);if(u[n(347)]-=l,u[n(346)]+=l,u[n(322)]-=l,u[n(338)]+=l,u[n(347)]=(0,h.u)(Math[n(319)](u[n(347)]),c,0),u.right=(0,h.u)(Math[n(332)](u.right),c,0),u.top=(0,h.u)(Math[n(332)](u[n(322)]),f,0),u[n(338)]=(0,h.u)(Math[n(332)](u.bottom),f,0),a[n(326)]&&(a[n(326)].left>u[n(347)]&&(u[n(347)]=Math[n(354)](a.selection[n(347)],u.right)),a[n(326)][n(346)]<u[n(346)]&&(u[n(346)]=Math[n(361)](a[n(326)][n(346)],u[n(347)])),a[n(326)][n(322)]>u.top&&(u[n(322)]=Math[n(354)](a[n(326)].top,u[n(338)])),a[n(326)][n(338)]<u[n(338)]&&(u[n(338)]=Math[n(361)](a.selection[n(338)],u[n(322)]))),u[n(347)]===u[n(346)]||u.top===u.bottom)throw new Error(n(340));const M=(0,i.Oq)(u),d=(0,i.rY)(u),x=.5,p=.5,g=.5,w=.5,y=new OffscreenCanvas(M,d)[n(362)]("2d");if(!y)throw new Error(n(366));y[n(352)]=n(313)+a[n(363)][0]+","+a[n(363)][1]+","+a[n(363)][2]+","+a[n(363)][3]/255+")",y.lineWidth=a[n(341)],y[n(336)](),a.smoothing||a[n(341)]%2!=0?(y[n(350)](r.x-u[n(347)]+x,r.y-u.top+p),y[n(349)](s.x-u.left+g,s.y-u[n(322)]+w)):(y.moveTo(Math[n(324)](r.x-u[n(347)]+x),Math[n(324)](r.y-u.top+p)),y[n(349)](Math.round(s.x-u[n(347)]+g),Math[n(324)](s.y-u[n(322)]+w))),y[n(358)]();const m=y[n(316)](0,0,M,d),b=(0,o.X$)(c*f,c*f*4,!0),I=(0,o.X$)(c*f*2,Math[n(361)](c,f),!0);let _=0,k=0,v=0,A=0;if(a[n(339)])for(v=0;v<d;v++)for(k=0;k<M;k++)A=4*(v*M+k),m.data[A+3]>0&&(I[2*_]=k,I[2*_+1]=v,b[_++]=4*((u[n(322)]+v)*c+u.left+k));else for(v=0;v<d;v++)for(k=0;k<M;k++)A=4*(v*M+k),m[n(342)][A+3]>a[n(363)][3]/2&&(m[n(342)][A+3]=a[n(363)][3],I[2*_]=k,I[2*_+1]=v,b[_++]=4*((u[n(322)]+v)*c+u[n(347)]+k));const D=b[n(344)](0,_);t.update(.25);const E=new Uint8Array(new SharedArrayBuffer(4*b[n(369)]));for(A=0;A<b[n(369)];A++)(0,o.Yr)(E,4*A,a[n(359)].data,b[A]);if(t[n(348)](.5),a[n(317)]===n(357))for(A=0;A<D[n(369)];A++)(0,o.Yr)(a[n(359)][n(342)],D[A],m[n(342)],4*(I[2*A+1]*M+I[2*A]));else for(A=0;A<D[n(369)];A++)(0,e.B)(a[n(317)],a[n(359)][n(342)],D[A],m[n(342)],4*(I[2*A+1]*M+I[2*A]));t[n(348)](.75);const B=new Uint8Array(new SharedArrayBuffer(4*b.length));for(A=0;A<b[n(369)];A++)(0,o.Yr)(B,4*A,a[n(359)][n(342)],b[A]);return t.update(1),{undoData:{indexList:D,colorData:E},redoData:{indexList:D,colorData:B},range:u}}(a,n)}},7742:(t,a,n)=>{n.d(a,{ap:()=>e,TO:()=>r,zg:()=>h});var o=n(1003);function e(t,a){const n=a52_0x5689,o=t[a];if(o[n(334)]<1||o[n(356)]<1)throw new Error(n(335)+a+n(321)+o[n(334)]+n(345)+o[n(356)])}function r(t,a,n){const o=a52_0x5689,e=t[a],r=t[n];if(e[o(334)]===r.width&&e[o(356)]===r[o(356)])throw new Error(o(360)+a+o(314)+n+o(364))}function h(t,a,n){const e=a52_0x5689,r=t[a];if(!(0,o.ur)(n,r))throw new Error(e(330)+a+'" '+(0,o.PW)(r)+" must be contained within "+(0,o.PW)(n))}},1019:(t,a,n)=>{n.d(a,{X:()=>r,j:()=>h});var o=n(8752),e=n(9455);function r(t,a,n,o,r,h){const i=a52_0x5689,s=(0,e.zz)(t,a,n,o),c=.5*h*r*Math[i(325)](s),f=.5*h*r*Math.cos(s);return[{x:t-c,y:a-f},{x:t+c,y:a+f},{x:n+c,y:o+f},{x:n-c,y:o-f}]}function h(t,a,n,o,e,r,h,l=1){h?function(t,a,n,o,e,r,h){const i=a52_0x5689;h<1&&(t=u(t,h));const s=Math.abs(e-n)>Math[i(371)](o-a);let l=0;s&&(l=a,a=n,n=l,l=o,o=e,e=l),a>o&&(l=a,a=o,o=l,l=n,n=e,e=l);const M=o-a;let d=(e-n)/M;0===M&&(d=1);let x=Math[i(324)](a),p=n+d*(x-a),g=f(a+.5);const w=x,y=Math[i(319)](p);let m=c(p)*g;s?(r(y,w,u(t,f(p)*g)),m>0&&r(y+1,w,u(t,m))):(r(w,y,u(t,f(p)*g)),m>0&&r(w,y+1,u(t,m)));let b=p+d;x=Math.round(o),p=e+d*(x-o),g=c(o+.5);const I=x,_=Math[i(319)](p);if(m=c(p)*g,s?(r(_,I,u(t,f(p)*g)),m>0&&r(_+1,I,u(t,c(p)*g))):(r(I,_,u(t,f(p)*g)),m>0&&r(I,_+1,u(t,c(p)*g))),s)for(let a=w+1;a<I;a++)r(Math.floor(b),a,u(t,f(b))),m=c(b),m>0&&r(Math[i(319)](b)+1,a,u(t,m)),b+=d;else for(let a=w+1;a<I;a++)r(a,Math.floor(b),u(t,f(b))),m=c(b),m>0&&r(a,Math[i(319)](b)+1,u(t,m)),b+=d}(t,a,n,o,e,r,l):function(t,a,n,o,e,r,h){const c=a52_0x5689;h<1&&(t=u(t,h)),Math[c(371)](e-n)<Math[c(371)](o-a)?a>o?i(t,o,e,a,n,r):i(t,a,n,o,e,r):n>e?s(t,o,e,a,n,r):s(t,a,n,o,e,r)}(t,a,n,o,e,r,l)}function i(t,a,n,o,e,r){const h=o-a;let i=e-n,s=1;i<0&&(s=-1,i=-i);let c=2*i-h,f=n;for(let n=a;n<=o;n++)r(n,f,t),c>0?(f+=s,c+=2*(i-h)):c+=2*i}function s(t,a,n,o,e,r){let h=o-a;const i=e-n;let s=1;h<0&&(s=-1,h=-h);let c=2*h-i,f=a;for(let a=n;a<=e;a++)r(f,a,t),c>0?(f+=s,c+=2*(h-i)):c+=2*h}function c(t){return t%1}function f(t){return 1-t%1}function u(t,a){if(void 0!==t)return o.m4.createReadonlyRgbaColor(t[0],t[1],t[2],Math.round(t[3]*a))}},9455:(t,a,n)=>{function o(t,a,n,o){return 180*e(t,a,n,o)/Math.PI}function e(t,a,n,o){let e=-Math[a52_0x5689(337)](o-a,n-t);return-180===e&&(e=180),e}function r(t){return t*Math.PI/180}function h(t,a,n,o,e,r){const h=a52_0x5689,i=Math[h(343)](Math[h(318)](t-n,2)+Math[h(318)](a-o,2)),s=Math[h(343)](Math.pow(n-e,2)+Math[h(318)](o-r,2)),c=Math[h(343)](Math.pow(e-t,2)+Math[h(318)](r-a,2)),f=(i+s+c)/2;return Math[h(343)](f*(f-i)*(f-s)*(f-c))}function i(t,a,n,o,e,r,i,s){return h(t,a,n,o,e,r)+h(n,o,e,r,i,s)+h(e,r,i,s,t,a)+h(i,s,t,a,n,o)}n.d(a,{AM:()=>o,zz:()=>e,Ht:()=>r,ku:()=>h,hu:()=>i})}}]);