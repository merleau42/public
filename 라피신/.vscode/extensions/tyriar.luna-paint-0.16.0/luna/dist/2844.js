"use strict";const a17_0x11d8=["createElement","resize-stroke-b-ew","_smoothingOption","temporaryLayer","append","pointerMove","_setupActiveTemporaryLayer","isValid","width","_topLeft","resize-stroke-b-ns","setVisible","getInfo","type","registerTemporaryLayer","_setState","shiftKey","classList","altKey","ArrowDown","_resizeStrokeB","_onUpdate","div","devicePixelRatio","secondary","_svgPath","overlay","onCommit","_onOptionsChange","step","historyService","darken","blendMode","pow","_angleInfo","setValueFromHistoryChange","boolean","_getCoords","_downPointA","style","fire","secondaryColor","point","join","ctrlKey","_getTopLeft","_outlineModel","length","_cursorInfo","_range","246328xunBdw","getFineCoordsFromEvent","key"," pixels tall","string-combo","54302xmZdPN","hasLineLayer","createDomRenderProgram","_updateOutline","Line top left position is x=","floor","appendChild","forceSolid","_getClosestSnapDegrees","Blend Mode","round","register","top","reduce","render","_angle","41716PLsyTD","prepend","clientHeight","_svg","Set Line Blend Mode","onHistoryUnset","Set Line Color","onUpdate","_imageService","Adjust Line","webpackChunkluna","min","pointA","2VFZRzm","max","removeChild","sin","zoom","_pointB","_onStateChange","_clearLineLayer","_container","none","_hideCursorInfo","setAttribute","config","_cursorCoord","viewportService","_finish","map","size","getDetailedInfo","atan2","triggerRequestRender","commit","lineLayer","_pointA","event","display","name","getColorFromPointerEvent"," 0z","_sc","_color","resize-stroke-b-nesw","resize-stroke-a-ns","createElementNS","Line is ","_elementContainer","_renderer","offsetY","cos","rgba","transparent","difference","primaryColor","taskWorkerService","smoothing","fill","topLeft","new","onTemporaryLayerRegistered","getPointerState","_isVisible","abs","toString","168582gPMCZI","_onRequestRender","_onHistoryUpdateValue","_isShiftDown","move-handle","path","_resizeStrokeA","getCoordsFromEvent","configService","screen","ArrowUp","createReadonlyRgbaColor","linearBurn","clientWidth","options","_viewportService","left","Draw Line","Line angle is ","5hJaTpj","range","pointB","isVisible","_downCoord","lighten","onBeforeRunLayerTask","82554UWWyHP","paletteService","Enable","_model","right","angle","topleft"," pixels wide by ","handleOptionUpdate","bottom","add","_blendModeOption"," x ","move","onStateChange","block","currentState","pointerUp","selectionService","unregisterTemporaryLayer","text","softLight","Brush Size","element","offsetX","_shiftPoints","Set Line Brush Size","snapToPixelGrid","deserialize","linearDodgeAdd","startsWith","resize-stroke-a-nesw","12059pDhCxD","sqrt","resize-stroke-a-ew","order","visible","keyDown","_element","_downPointB","primary","http://www.w3.org/2000/svg","var(--luna-focusColor)","_updateCursorInfo","value","move-point-a","imageService","_value","Smoothing","_refreshInfo","strokeWidth","41714ZQYYTB","_lineLayerOwner","buttons","cursor-info","svg","_updateColors","zone","ArrowRight","stroke","number","_brushSizeOption","_syncOutlineModelToLayer","l0 ","pointerDown","_lengthInfo","replace","hasImage","onRequestRender","height","_setPointPosition","_topLeftInfo","state","_getLineLength","push","multiply","allowUnchecking","_getAngle","resize-stroke-b-nwse","move-point-b","includes","_sizeInfo","ArrowLeft","onHistoryAction","string","onHistoryUpdateValue","normal","exclusion","line","currentLayer","Disable"],a17_0x47a8=function(t,s){return a17_0x11d8[t-=374]},a17_0x318ff4=a17_0x47a8;!function(t,s){const i=a17_0x47a8;for(;;)try{if(149751===-parseInt(i(457))+-parseInt(i(581))*parseInt(i(568))+-parseInt(i(438))*-parseInt(i(399))+parseInt(i(406))+parseInt(i(547))+parseInt(i(552))+-parseInt(i(380)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a17_0x11d8),(self[a17_0x318ff4(578)]=self[a17_0x318ff4(578)]||[])[a17_0x318ff4(480)]([[2844],{7571:(t,s,i)=>{i.d(s,{P:()=>h});var e=i(5120);class h extends e.JT{constructor(t,s){const i=a17_0x47a8;super(),this[i(589)]=t,this[i(409)]=s,this[i(441)]=2,this[i(444)]=document[i(497)](i(519)),this[i(444)].classList[i(416)](i(460)),this[i(589)][i(558)](this[i(444)]),this[i(563)]({dispose:()=>this[i(589)][i(583)](this[i(444)])})}render(){const t=a17_0x47a8;this[t(444)][t(536)].display=this[t(409)].isVisible?"block":"none",this[t(444)][t(536)][t(396)]=this[t(409)].x+"px",this[t(444)][t(536)][t(564)]=this[t(409)].y+"px",this[t(444)].textContent=this[t(409)][t(426)]}}},566:(t,s,i)=>{const e=a17_0x318ff4;i.d(s,{d:()=>r,I:()=>a});var h=i(1019),n=i(5120),o=i(1674);class r extends n.JT{constructor(t,s,i,e){const h=a17_0x47a8;super(),this._container=t,this[h(576)]=s,this[h(395)]=i,this[h(409)]=e,this[h(441)]=2,this[h(571)]=document[h(614)](o.q,h(461)),this[h(522)]=document[h(614)](o.q,h(385)),this[h(522)][h(536)][h(465)]=h(448),this[h(522)][h(536)][h(626)]=h(621),this._svgPath[h(536)][h(456)]="1",this._svg[h(501)](this[h(522)]),this[h(589)][h(569)](this[h(571)]),this[h(563)]({dispose:()=>this[h(589)].removeChild(this[h(571)])})}[e(566)](){const t=e,s=this[t(395)];if(!this[t(409)].isValid||!this[t(576)][t(495)])return void(this[t(571)][t(536)].display=t(590));if(this[t(571)][t(536)][t(606)]=t(421),!this[t(409)][t(559)]&&this[t(409)].strokeWidth<=1&&s.zoom>=3){const i=[];(0,h.j)(void 0,this[t(409)].x1,this[t(409)].y1,this[t(409)].x2,this[t(409)].y2,((s,e)=>i[t(480)]([s,e])),!1,this[t(409)][t(456)]);const e=[];let n=0;for(;n<i.length-1;n++){const s=i[n];let h=n;if(s[0]===i[h+1][0]){for(;h+1<i.length&&s[0]===i[h+1][0];)h++;e.push([s[0],s[1],1,h-n+1])}else if(s[1]===i[h+1][1]){for(;h+1<i[t(544)]&&s[1]===i[h+1][1];)h++;e.push([s[0],s[1],h-n+1,1])}else e[t(480)]([s[0],s[1],1,1]);n=h}n===i[t(544)]-1&&e[t(480)]([i[n][0],i[n][1],1,1]);const o=Math[t(562)](this[t(589)][t(393)]/2)-this[t(576)][t(505)]/2*s[t(585)]+s.x*s[t(585)],r=Math[t(562)](this[t(589)].clientHeight/2)-this[t(576)][t(475)]/2*s[t(585)]+s.y*s[t(585)];let a="";for(const i of e)a+="M"+(o+i[0]*s[t(585)])+" "+(r+i[1]*s[t(585)]),a+="l"+i[2]*s[t(585)]+" 0",a+=t(469)+i[3]*s[t(585)],a+="l-"+i[2]*s[t(585)]+t(609);return this._svg[t(592)](t(505),this._container[t(393)][t(379)]()),this[t(571)][t(592)](t(475),this[t(589)][t(570)][t(379)]()),void this[t(522)][t(592)]("d",a)}this._svg[t(536)][t(606)]=t(421);const i=Math[t(562)](this[t(589)][t(393)]/2)-this[t(576)][t(505)]/2*s[t(585)]+s.x*s[t(585)],n=Math[t(562)](this[t(589)][t(570)]/2)-this[t(576)][t(475)]/2*s[t(585)]+s.y*s.zoom,o=i+(this[t(409)].x1+.5)*s[t(585)],r=n+(this[t(409)].y1+.5)*s[t(585)],a=i+(this[t(409)].x2+.5)*s.zoom,c=n+(this[t(409)].y2+.5)*s[t(585)];if(this[t(571)][t(592)]("width",this[t(589)][t(393)][t(379)]()),this._svg[t(592)](t(475),this[t(589)][t(570)][t(379)]()),s[t(585)]>=3){const i=(0,h.X)(o,r,a,c,this._model[t(456)],s[t(585)]);this[t(522)][t(592)]("d","M"+i[t(597)]((t=>t.x+","+t.y))[t(540)](" L")+"z")}else this[t(522)][t(592)]("d","M"+o+","+r+" L"+a+","+c)}}class a{constructor(){const t=e;this.isValid=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this[t(456)]=1,this[t(559)]=!1}}},9865:(t,s,i)=>{i.d(s,{q:()=>n});var e=i(1815),h=i(5120);class n extends h.JT{constructor(){const t=a17_0x47a8;super(...arguments),this._onUpdate=this[t(563)](new e.v),this.onUpdate=this[t(518)].event}}},9904:(t,s,i)=>{const e=a17_0x318ff4;i.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>u,qv:()=>d});var h=i(1815),n=i(5120),o=i(2939);class r extends n.JT{constructor(t,s,i,e=!0){const n=a17_0x47a8;super(),this[n(607)]=t,this[n(473)]=s,this._value=i,this[n(482)]=e,this.type=n(533),this._onHistoryUpdateValue=this[n(563)](new h.v),this[n(491)]=this[n(382)][n(605)],this._onUpdate=this[n(563)](new h.v),this.onUpdate=this._onUpdate[n(605)]}get[e(450)](){return this[e(453)]}set[e(450)](t){const s=e;this[s(453)]=t,this[s(518)].fire(t)}[e(532)](t){const s=e;this[s(453)]=t,this[s(382)][s(537)](t)}}class a extends n.JT{constructor(t,s,i){const n=e;super(),this.name=t,this[n(394)]=s,this._value=i,this[n(510)]=n(490),this._onHistoryUpdateValue=this[n(563)](new h.v),this[n(491)]=this[n(382)][n(605)],this._onUpdate=this.register(new h.v),this[n(575)]=this[n(518)].event}get[e(450)](){return this[e(453)]}set[e(450)](t){const s=e;this[s(453)]=t,this._onUpdate[s(537)](t)}setValueFromHistoryChange(t){const s=e;this._value=t,this[s(382)][s(537)](t)}}class c extends n.JT{constructor(t,s,i){const n=e;super(),this[n(607)]=t,this.options=s,this[n(453)]=i,this[n(510)]=n(551),this[n(382)]=this[n(563)](new h.v),this[n(491)]=this[n(382)][n(605)],this[n(518)]=this[n(563)](new h.v),this.onUpdate=this._onUpdate.event}get value(){return this._value}set[e(450)](t){const s=e;this._value=t,this[s(518)][s(537)](t)}[e(532)](t){const s=e;this[s(453)]=t,this[s(382)][s(537)](t)}}class l extends a{constructor(){const t=e;super("Blend Mode",[t(492),t(472),"darken",t(481),t(392),t(404),"screen",t(435),t(523),"softLight",t(622),"exclusion"],t(492))}}class u extends n.JT{constructor(t,s,i,n){const o=e;super(),this[o(607)]=t,this[o(453)]=s,this[o(579)]=i,this[o(582)]=n,this[o(510)]=o(466),this[o(382)]=this[o(563)](new h.v),this[o(491)]=this[o(382)].event,this._onUpdate=this[o(563)](new h.v),this[o(575)]=this[o(518)][o(605)]}get[e(450)](){const t=e;return(0,o.u)(this._value,this[t(582)],this[t(579)])}set[e(450)](t){const s=e;this._value=t,this[s(518)][s(537)](t)}[e(532)](t){const s=e;this[s(453)]=t,this[s(382)][s(537)](t)}}class d extends u{constructor(t,s,i,h){const n=e;super(t,s,i,h),this[n(510)]=n(466)}get[e(450)](){const t=e;return(0,o.u)(this[t(453)],this.max,this.min)}set[e(450)](t){const s=e;this[s(453)]=Math[s(557)](t),this[s(518)][s(537)](t)}}},2844:(t,s,i)=>{const e=a17_0x318ff4;i.r(s),i.d(s,{default:()=>m});var h=i(8752),n=i(1815),o=i(1019),r=i(5120),a=i(2939),c=i(7896),l=i(1003),u=i(9455);function d(t){if(void 0!==t)return{x:t.x,y:t.y}}var _=i(2811),p=i(7571),y=i(566),f=i(9865),x=i(9904);const v=[-180,-165,-150,-135,-120,-105,-90,-75,-60,-45,-30,-15,0,15,30,45,60,75,90,105,120,135,150,165,180];class g extends r.JT{constructor(t){const s=a17_0x47a8;super(),this[s(610)]=t,this.id="line",this[s(478)]=s(374),this[s(594)]=[0,0],this[s(383)]=!1,this._outlineModel=new y.I,this[s(417)]=new x.Jp,this[s(499)]=new x.FV(s(454),!0,!0),this._brushSizeOption=new x.X5(s(428),1,0,1e3),this[s(394)]=[this[s(417)],this[s(499)],this._brushSizeOption],this[s(477)]=new M,this._sizeInfo=new L,this[s(471)]=new w,this._angleInfo=new S,this.info=[this._topLeftInfo,this._sizeInfo,this[s(471)],this[s(531)]],this._onRequestRender=this[s(563)](new n.v),this[s(474)]=this[s(381)][s(605)],this._onStateChange=this.register(new n.v),this[s(420)]=this[s(587)][s(605)],this[s(545)]={x:0,y:0,text:"",isVisible:!1},this[s(563)](this[s(610)][s(452)].onLayerChange((()=>this._finish()))),this[s(563)](this[s(610)].taskService[s(405)]((()=>this[s(596)]()))),this.register({dispose:()=>this[s(596)]()}),this[s(563)](this[s(610)][s(595)].onUpdate((()=>this[s(591)]()))),this[s(543)].forceSolid=this[s(499)].value,this[s(563)](this[s(610)][s(407)][s(575)]((()=>this._updateColors()))),this.register(this._blendModeOption[s(575)]((t=>this[s(603)]?.handleOptionUpdate(t,s(529),s(572))))),this[s(563)](this[s(499)][s(575)]((t=>{const i=s;this[i(543)].forceSolid=t,this.lineLayer?.handleOptionUpdate(t,i(625),i(t?408:496)+" Line Smoothing")}))),this[s(563)](this[s(467)][s(575)]((t=>{const i=s;this[i(543)][i(456)]=t,this.lineLayer?.[i(414)](t,i(456),i(432),!0)}))),this[s(563)](this[s(610)].imageService[s(375)]((t=>this._setupActiveTemporaryLayer(t)))),this[s(610)].imageService[s(495)]?.[s(500)]&&this[s(503)](this._sc[s(452)][s(495)].temporaryLayer)}[e(503)](t){const s=e;t[s(510)]===s(494)&&(this.lineLayer=t,this[s(563)](this[s(603)][s(524)]((()=>this[s(588)]()))),this[s(563)](this[s(603)][s(489)]((()=>{const t=s;this[t(525)](),this[t(455)](),this[t(555)](null,!1),this[t(468)]()}))),this[s(563)](this.lineLayer[s(573)]((()=>this[s(588)]()))),this._renderer?.[s(508)](!0),this[s(381)][s(537)]())}[e(525)](){const t=e;this[t(603)]&&(this[t(417)][t(532)](this[t(603)][t(422)].blendMode),this._brushSizeOption[t(532)](this.lineLayer[t(422)].strokeWidth),this[t(499)][t(532)](this[t(603)].currentState[t(625)]),(!(0,h.WC)(this[t(610)][t(407)][t(446)][t(620)],this[t(603)][t(422)][t(623)])||!(0,h.WC)(this._sc[t(407)][t(521)][t(620)],this[t(603)][t(422)][t(538)]))&&this[t(610)][t(407)].setColors(this[t(603)][t(422)][t(623)],this.lineLayer[t(422)][t(538)]))}[e(462)](){const t=e;if(!this[t(603)])return;const s=this._sc[t(407)][t(446)][t(620)],i=this[t(610)][t(407)][t(521)][t(620)];(0,h.WC)(this[t(603)][t(422)][t(623)],s)&&(0,h.WC)(this.lineLayer[t(422)][t(538)],i)||(this.lineLayer[t(422)].primaryColor=s,this[t(603)].currentState[t(538)]=i,this[t(603)].step(t(574),!0),this[t(603)][t(601)]())}async[e(596)](){const t=e;await(this[t(603)]?.[t(602)]()),this._clearLineLayer()}[e(588)](){const t=e;this[t(603)]=void 0,this._renderer?.[t(508)](!1),this[t(543)][t(504)]=!1,this[t(455)](),this[t(381)][t(537)]()}[e(554)](t){const s=e;return this[s(617)]=new k(t,this,this._sc.viewportService,this[s(610)][s(452)]),this[s(617)][s(508)](!!this[s(603)]),[new p.P(t,this[s(545)]),new y.d(t,this[s(610)][s(452)],this._sc[s(595)],this[s(543)]),this[s(617)]]}async[e(470)](t){const s=e,i=this._sc[s(452)].currentLayer;if(!i)return;if(this[s(611)]=this[s(610)][s(407)][s(608)](t),!this[s(611)])return;if(this[s(403)]=this[s(534)](t),this.state!==s(374))return this[s(535)]=d(this[s(603)]?.[s(422)][s(580)]),void(this._downPointB=d(this.lineLayer?.[s(422)][s(401)]));this[s(594)]=[...this[s(403)]];const h=!(1&t[s(459)]);this[s(603)]=new _.B(i,{invertColors:h},{primaryColor:this._sc[s(407)].primary[s(620)],secondaryColor:this._sc[s(407)][s(521)][s(620)],pointA:{x:this[s(403)][0],y:this[s(403)][1]},pointB:{x:this[s(594)][0],y:this[s(594)][1]},blendMode:this[s(417)][s(450)],smoothing:this._smoothingOption.value,strokeWidth:this[s(467)][s(450)]},this[s(610)][s(527)],this[s(610)][s(424)],this._sc[s(624)]),this._updateOutline(t,!0),await i[s(511)](this.lineLayer)}[e(534)](t){const s=e;if(this._smoothingOption[s(450)]&&!this[s(610)][s(388)][s(593)][s(433)]){const i=this[s(610)][s(595)][s(548)](t);return i[0]-=.5,i[1]-=.5,i}return this[s(610)][s(595)][s(387)](t)}pointerDownMove(t){const s=e;this[s(403)]&&this._color&&this[s(610)][s(452)].currentLayer&&this[s(555)](t,!0)}async[e(423)](t,s){const i=e;if("new"===this[i(478)]&&s)return this[i(603)]&&this[i(610)][i(452)][i(495)]?.[i(425)](this[i(603)]),this.lineLayer?.dispose(),void this._clearLineLayer();if(!this[i(403)]||!this[i(603)]||!this._color)return;let h;switch(this[i(478)]){case i(374):h=i(397);break;case"move":h="Move Line";break;default:h=i(577)}this[i(603)][i(422)][i(580)].x=this[i(543)].x1,this[i(603)][i(422)][i(580)].y=this[i(543)].y1,this.lineLayer[i(422)][i(401)].x=this[i(543)].x2,this[i(603)][i(422)][i(401)].y=this[i(543)].y2,this[i(603)][i(526)](h),this[i(403)]=void 0,this[i(502)](t,!1)}async pointerMove(t,s){const i=e;this[i(545)].x=t[i(430)],this._cursorInfo.y=t[i(618)],this[i(594)]=this._getCoords(t),s&&t[i(513)]?this[i(449)]():this[i(545)][i(402)]&&this[i(591)](),!s&&this._renderer&&this[i(512)](this[i(617)][i(376)](t,this._brushSizeOption.value,this[i(610)][i(595)][i(585)]))}_setState(t){const s=e;this[s(478)]!==t&&(this[s(478)]=t,this[s(587)][s(537)]())}[e(443)](t,s){const i=e;if(!this[i(383)]&&t[i(513)]&&(this[i(383)]=!0,this[i(555)](t,s)),this.lineLayer&&!s&&[i(390),i(488),i(516),i(464)][i(486)](t[i(549)])){const s=(c.V5?t.metaKey:t[i(541)])?10:1;switch(t.key){case i(390):this[i(431)](0,-s);break;case"ArrowDown":this[i(431)](0,s);break;case i(488):this[i(431)](-s,0);break;case i(464):this[i(431)](s,0)}this[i(603)][i(526)]("Shift Line"),this[i(603)][i(601)]()}this._refreshInfo()}_shiftPoints(t,s){const i=e;this[i(603)]&&(this[i(603)].currentState[i(580)].x+=t,this[i(603)][i(422)][i(580)].y+=s,this[i(603)][i(422)][i(401)].x+=t,this[i(603)][i(422)][i(401)].y+=s,this._outlineModel.x1+=t,this[i(543)].y1+=s,this[i(543)].x2+=t,this[i(543)].y2+=s)}keyUp(t,s){const i=e;!t[i(513)]&&(this[i(383)]=!1,this[i(555)](t,s)),this._refreshInfo()}[e(555)](t,s){const i=e,h=this[i(603)]?.currentState[i(580)],n=this[i(603)]?.[i(422)][i(401)];if(!(s&&this[i(403)]&&h&&n))return(!h||!n)&&(this[i(543)][i(504)]=!1),void this[i(455)]();if(this[i(478)][i(436)]("resize-stroke")){const t=(h.x+n.x)/2,s=(h.y+n.y)/2;let e=2*Math[i(439)](Math.pow(t-this._cursorCoord[0],2)+Math[i(530)](s-this[i(594)][1],2));return e=!this[i(499)][i(450)]||this[i(610)][i(388)][i(593)].snapToPixelGrid?Math.max(Math[i(562)](e),1):(0,a.s)(e,2),this._brushSizeOption[i(450)]=e,this[i(467)].setValueFromHistoryChange(e),void this._refreshInfo()}let o="move-point-b"===this[i(478)]?[n.x,n.y]:[h.x,h.y];const r="move-point-b"===this.state?[h.x,h.y]:[n.x,n.y];if(this[i(383)]&&"move"!==this.state){const t=this._getAngle(r,o),s=(0,u.Ht)(this[i(560)](t)),e=Math.sqrt(Math[i(530)](r[0]-o[0],2)+Math[i(530)](r[1]-o[1],2));o=[r[0]+e*Math[i(619)](s),r[1]-e*Math[i(584)](s)],!this[i(499)].value&&(o[0]=Math[i(562)](o[0]),o[1]=Math[i(562)](o[1]))}if(this[i(543)].x1=r[0],this._outlineModel.y1=r[1],t[i(515)])switch(this[i(478)]){case i(374):this[i(543)].x1=2*this._downCoord[0]-o[0],this[i(543)].y1=2*this[i(403)][1]-o[1];break;case"move-point-a":this[i(445)]&&(this._outlineModel.x1=2*this._downPointB.x-o[0],this[i(543)].y1=2*this[i(445)].y-o[1]);break;case"move-point-b":this[i(535)]&&(this[i(543)].x1=2*this[i(535)].x-o[0],this[i(543)].y1=2*this[i(535)].y-o[1])}if(this[i(543)].x2=o[0],this[i(543)].y2=o[1],this._outlineModel[i(456)]=this[i(467)][i(450)],this[i(543)].isValid=!0,this.lineLayer)switch(this[i(478)]){case i(374):case i(451):this[i(603)][i(422)][i(580)].x=this[i(594)][0],this[i(603)].currentState.pointA.y=this[i(594)][1];break;case i(485):this[i(603)].currentState.pointB.x=this[i(594)][0],this[i(603)][i(422)][i(401)].y=this._cursorCoord[1];break;case i(419):this[i(535)]&&this[i(445)]&&(this[i(603)][i(422)].pointA.x=this[i(535)].x+this[i(594)][0]-this[i(403)][0],this[i(603)][i(422)][i(580)].y=this[i(535)].y+this[i(594)][1]-this[i(403)][1],this[i(603)][i(422)][i(401)].x=this[i(445)].x+this[i(594)][0]-this[i(403)][0],this[i(603)].currentState[i(401)].y=this[i(445)].y+this[i(594)][1]-this[i(403)][1])}this[i(381)][i(537)](),this[i(449)](),this[i(455)]()}[e(449)](){const t=e;this[t(403)]&&this[t(594)]&&this[t(603)]&&this[t(478)]!==t(419)&&(this[t(567)]=this[t(483)]([this[t(603)][t(422)].pointB.x,this[t(603)][t(422)][t(401)].y],[this[t(603)][t(422)][t(580)].x,this.lineLayer[t(422)].pointA.y]),this[t(383)]&&(this._angle=this[t(560)](this[t(567)])),this[t(545)][t(426)]=this._angle+"°",this[t(545)].isVisible=this[t(383)],this[t(381)][t(537)]())}[e(483)](t,s){return(0,a.s)((0,u.AM)(t[0],t[1],s[0],s[1]),1)}[e(560)](t){const s=e;return v[s(565)](((i,e)=>Math[s(378)](e-t)<Math[s(378)](i-t)?e:i))}[e(591)](){const t=e;this[t(545)][t(402)]=!1,this[t(381)][t(537)]()}_refreshInfo(){const t=e;this[t(603)]?(this._topLeftInfo[t(627)]=this._getTopLeft(),this._sizeInfo[t(400)]=(0,l.tH)(this[t(603)][t(422)][t(580)].x,this.lineLayer[t(422)][t(580)].y,this[t(603)].currentState[t(401)].x,this.lineLayer[t(422)][t(401)].y),this._lengthInfo[t(400)]=this[t(487)][t(400)],this[t(531)][t(411)]=this[t(567)]):(this[t(477)][t(627)]=void 0,this[t(487)][t(400)]=void 0,this[t(471)].range=void 0,this[t(531)][t(411)]=void 0)}[e(542)](){const t=e;if(!this[t(603)])return;const s=this[t(603)].currentState,i=s[t(580)].x<s.pointB.x?s[t(580)]:s[t(401)],h=s[t(580)].y<s[t(401)].y?s.pointA:s[t(401)];return{x:i.x,y:h.y}}_syncOutlineModelToLayer(){const t=e;this[t(603)]&&(this[t(543)][t(559)]=this[t(603)][t(422)][t(625)],this[t(543)][t(456)]=this[t(603)][t(422)][t(456)],this[t(543)].x1=this[t(603)].currentState[t(580)].x,this[t(543)].y1=this[t(603)][t(422)].pointA.y,this._outlineModel.x2=this[t(603)].currentState[t(401)].x,this[t(543)].y2=this[t(603)][t(422)][t(401)].y,this[t(543)].isValid=!0)}serialize(){const t=e;return{state:this[t(478)],hasLineLayer:!!this[t(603)],angle:this[t(567)]}}[e(434)](t){const s=e;this._angle=t[s(411)],t[s(553)]?(this._renderer?.[s(508)](!0),this[s(468)]()):this._clearLineLayer(),this[s(512)](t.state),this[s(525)](),this._refreshInfo()}}const m=g;class M extends f.q{constructor(){const t=e;super(...arguments),this[t(510)]=t(412)}set[e(627)](t){const s=e;var i,h;h=t,!(!(i=this[s(506)])&&!h||i&&h&&i.x===h.x&&i.y===h.y)&&(this[s(506)]=t,this[s(518)][s(537)]())}get[e(442)](){return!!this._topLeft}[e(509)](){const t=e;return this[t(506)]?(0,a.s)(this[t(506)].x,2)+", "+(0,a.s)(this[t(506)].y,2):""}[e(599)](){const t=e;return this._topLeft?t(556)+(0,a.s)(this[t(506)].x,2)+" y="+(0,a.s)(this[t(506)].y,2):""}}class L extends f.q{constructor(){const t=e;super(...arguments),this.type=t(598)}get range(){return this[e(546)]}set[e(400)](t){const s=e;this[s(546)]!==t&&(this[s(546)]=t,this._onUpdate[s(537)]())}get[e(442)](){return!!this[e(546)]}[e(509)](){const t=e;if(!this[t(546)])return"";const s=(0,a.s)((0,l.Oq)(this._range)-1,2),i=(0,a.s)((0,l.rY)(this[t(546)])-1,2);return s+t(418)+i}[e(599)](){const t=e;if(!this[t(546)])return"";const s=(0,a.s)((0,l.Oq)(this[t(546)])-1,2),i=(0,a.s)((0,l.rY)(this._range)-1,2);return t(615)+s+t(413)+i+t(550)}}class w extends f.q{constructor(){const t=e;super(...arguments),this.type=t(544)}set[e(400)](t){const s=e;this[s(546)]!==t&&(this[s(546)]=t,this[s(518)][s(537)]())}get[e(442)](){return!!this[e(546)]}[e(509)](){const t=e,s=this[t(479)]();return void 0===s?"":s[t(379)]()}getDetailedInfo(){const t=this[e(479)]();return void 0===t?"":"Line is "+t+" pixels long"}[e(479)](){const t=e;if(!this[t(546)])return;const s=(0,l.Oq)(this[t(546)])-1,i=(0,l.rY)(this[t(546)])-1,h=Math.sqrt(Math[t(530)](s,2)+Math[t(530)](i,2));return(0,a.s)(h,2)}}class S extends f.q{constructor(){const t=e;super(...arguments),this.type=t(411)}set[e(411)](t){const s=e;this[s(567)]!==t&&(this[s(567)]=t,this[s(518)][s(537)]())}get[e(442)](){return void 0!==this[e(567)]}[e(509)](){const t=e;return void 0===this._angle?"":this[t(567)]+"°"}getDetailedInfo(){const t=e;return void 0===this._angle?"":t(398)+this._angle+"°"}}function b(){const t=e;return{point:{x:-1,y:-1},element:document[t(497)](t(519)),zone:(0,l.Pq)()}}class k extends r.JT{constructor(t,s,i,h){const n=e;super(),this[n(589)]=t,this._lineLayerOwner=s,this._viewportService=i,this[n(576)]=h,this[n(441)]=2,this._pointA=b(),this._pointB=b(),this[n(386)]=b(),this[n(517)]=b(),this._isVisible=!0,this[n(616)]=document[n(497)]("div"),this[n(604)][n(429)][n(514)].add(n(384)),this._pointB[n(429)][n(514)][n(416)](n(384)),this[n(386)].element[n(514)][n(416)]("move-handle"),this[n(517)][n(429)].classList[n(416)]("move-handle"),this[n(616)].append(this[n(604)].element,this[n(586)][n(429)],this[n(386)][n(429)],this[n(517)].element),this._container[n(558)](this._elementContainer),this[n(563)]({dispose:()=>{const t=n;this[t(589)][t(583)](this[t(616)])}})}[e(508)](t){const s=e;t!==this._isVisible&&(this[s(616)].style[s(606)]=t?"":s(590),this[s(377)]=t)}[e(566)](){const t=e;if(!this[t(458)][t(603)])return;const s=this[t(576)].currentLayer;if(!s)return;const i=this._lineLayerOwner[t(603)][t(422)][t(580)],h=this[t(458)][t(603)][t(422)][t(401)],n=this._viewportService,r=Math.round(this[t(589)][t(393)]/2)-s[t(505)]/2*n[t(585)],a=Math[t(562)](this[t(589)][t(570)]/2)-s[t(475)]/2*n[t(585)];this._setPointPosition(this[t(604)],r+(n.x+i.x+.5)*n[t(585)],a+(n.y+i.y+.5)*n[t(585)]),this[t(476)](this[t(586)],r+(n.x+h.x+.5)*n[t(585)],a+(n.y+h.y+.5)*n[t(585)]);const c=(0,o.X)(this._pointA.point.x,this[t(604)].point.y,this[t(586)].point.x,this[t(586)].point.y,this[t(458)][t(603)][t(422)].strokeWidth,n.zoom);this[t(476)](this._resizeStrokeA,(c[1].x+c[2].x)/2,(c[1].y+c[2].y)/2),this[t(476)](this[t(517)],(c[3].x+c[0].x)/2,(c[3].y+c[0].y)/2)}[e(476)](t,s,i){const h=e,n=10*window[h(520)];t[h(539)].x=s,t[h(539)].y=i,t[h(463)][h(396)]=t[h(539)].x-n,t[h(463)][h(410)]=t[h(539)].x+n,t[h(463)][h(564)]=t.point.y-n,t[h(463)][h(415)]=t[h(539)].y+n,t[h(429)].style[h(396)]=t[h(539)].x+"px",t.element[h(536)].top=t[h(539)].y+"px"}getPointerState(t,s,i){const h=e;if(!this._lineLayerOwner[h(603)])return h(374);if(C(this[h(604)][h(463)],t[h(430)],t[h(618)]))return h(451);if(C(this[h(586)][h(463)],t[h(430)],t[h(618)]))return h(485);if(this[h(604)]&&this._pointB){if(C(this[h(386)][h(463)],t[h(430)],t.offsetY)){const t=((0,u.AM)(this._pointA[h(539)].x,this._pointA.point.y,this._pointB[h(539)].x,this[h(586)][h(539)].y)+180)%180;return t<22.5?h(613):t<67.5?"resize-stroke-a-nwse":t<112.5?h(440):t<157.5?h(437):"resize-stroke-a-ns"}if(C(this._resizeStrokeB.zone,t.offsetX,t[h(618)])){const t=((0,u.AM)(this._pointA[h(539)].x,this[h(604)].point.y,this[h(586)][h(539)].x,this[h(586)].point.y)+180)%180;return h(t<22.5?507:t<67.5?484:t<112.5?498:t<157.5?612:507)}}const n=(0,o.X)(this[h(604)][h(539)].x,this[h(604)][h(539)].y,this[h(586)][h(539)].x,this._pointB[h(539)].y,s,i),r=Math[h(562)]((0,u.hu)(n[0].x,n[0].y,n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y)),a=Math[h(562)](2*((0,u.ku)(n[0].x,n[0].y,n[1].x,n[1].y,t[h(430)],t[h(618)])+(0,u.ku)(n[1].x,n[1].y,n[2].x,n[2].y,t.offsetX,t[h(618)])+(0,u.ku)(n[2].x,n[2].y,n[3].x,n[3].y,t[h(430)],t[h(618)])+(0,u.ku)(n[3].x,n[3].y,n[0].x,n[0].y,t[h(430)],t[h(618)])));return h(a<=r?419:374)}}function C(t,s,i){const h=e;return s>=t[h(396)]&&s<t.right&&i>=t.top&&i<t[h(415)]}},1019:(t,s,i)=>{i.d(s,{X:()=>n,j:()=>o});var e=i(8752),h=i(9455);function n(t,s,i,e,n,o){const r=a17_0x47a8,a=(0,h.zz)(t,s,i,e),c=.5*o*n*Math[r(584)](a),l=.5*o*n*Math[r(619)](a);return[{x:t-c,y:s-l},{x:t+c,y:s+l},{x:i+c,y:e+l},{x:i-c,y:e-l}]}function o(t,s,i,e,h,n,o,d=1){o?function(t,s,i,e,h,n,o){const r=a17_0x47a8;o<1&&(t=u(t,o));const a=Math[r(378)](h-i)>Math.abs(e-s);let d=0;a&&(d=s,s=i,i=d,d=e,e=h,h=d),s>e&&(d=s,s=e,e=d,d=i,i=h,h=d);const _=e-s;let p=(h-i)/_;0===_&&(p=1);let y=Math[r(562)](s),f=i+p*(y-s),x=l(s+.5);const v=y,g=Math[r(557)](f);let m=c(f)*x;a?(n(g,v,u(t,l(f)*x)),m>0&&n(g+1,v,u(t,m))):(n(v,g,u(t,l(f)*x)),m>0&&n(v,g+1,u(t,m)));let M=f+p;y=Math[r(562)](e),f=h+p*(y-e),x=c(e+.5);const L=y,w=Math.floor(f);if(m=c(f)*x,a?(n(w,L,u(t,l(f)*x)),m>0&&n(w+1,L,u(t,c(f)*x))):(n(L,w,u(t,l(f)*x)),m>0&&n(L,w+1,u(t,c(f)*x))),a)for(let s=v+1;s<L;s++)n(Math[r(557)](M),s,u(t,l(M))),m=c(M),m>0&&n(Math[r(557)](M)+1,s,u(t,m)),M+=p;else for(let s=v+1;s<L;s++)n(s,Math[r(557)](M),u(t,l(M))),m=c(M),m>0&&n(s,Math.floor(M)+1,u(t,m)),M+=p}(t,s,i,e,h,n,d):function(t,s,i,e,h,n,o){const c=a17_0x47a8;o<1&&(t=u(t,o)),Math[c(378)](h-i)<Math.abs(e-s)?s>e?r(t,e,h,s,i,n):r(t,s,i,e,h,n):i>h?a(t,e,h,s,i,n):a(t,s,i,e,h,n)}(t,s,i,e,h,n,d)}function r(t,s,i,e,h,n){const o=e-s;let r=h-i,a=1;r<0&&(a=-1,r=-r);let c=2*r-o,l=i;for(let i=s;i<=e;i++)n(i,l,t),c>0?(l+=a,c+=2*(r-o)):c+=2*r}function a(t,s,i,e,h,n){let o=e-s;const r=h-i;let a=1;o<0&&(a=-1,o=-o);let c=2*o-r,l=s;for(let s=i;s<=h;s++)n(l,s,t),c>0?(l+=a,c+=2*(o-r)):c+=2*o}function c(t){return t%1}function l(t){return 1-t%1}function u(t,s){const i=a17_0x47a8;if(void 0!==t)return e.m4[i(391)](t[0],t[1],t[2],Math.round(t[3]*s))}},1674:(t,s,i)=>{const e=a17_0x318ff4;i.d(s,{q:()=>h});const h=e(447)},9455:(t,s,i)=>{function e(t,s,i,e){return 180*h(t,s,i,e)/Math.PI}function h(t,s,i,e){let h=-Math[a17_0x47a8(600)](e-s,i-t);return-180===h&&(h=180),h}function n(t){return t*Math.PI/180}function o(t,s,i,e,h,n){const o=a17_0x47a8,r=Math[o(439)](Math[o(530)](t-i,2)+Math[o(530)](s-e,2)),a=Math[o(439)](Math[o(530)](i-h,2)+Math[o(530)](e-n,2)),c=Math[o(439)](Math[o(530)](h-t,2)+Math[o(530)](n-s,2)),l=(r+a+c)/2;return Math[o(439)](l*(l-r)*(l-a)*(l-c))}function r(t,s,i,e,h,n,r,a){return o(t,s,i,e,h,n)+o(i,e,h,n,r,a)+o(h,n,r,a,t,s)+o(r,a,t,s,i,e)}i.d(s,{AM:()=>e,zz:()=>h,Ht:()=>n,ku:()=>o,hu:()=>r})}}]);