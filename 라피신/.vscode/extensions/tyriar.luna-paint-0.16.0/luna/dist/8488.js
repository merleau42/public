"use strict";const a24_0x308d=["1.1","bottom","_svg","value","lighten","path","var(--luna-focusColor)","move","_refreshInfo","register","deserialize","toString","_getAlignmentValue","createElementNS","bottomright","new","Left alignment","pointerMove","normal","render","cursive","_imageService","_sc","paletteService","primary","_createRange","Resize Text","_onHistoryUpdateValue","http://www.w3.org/2000/svg","_clearLayer","event","text-tool-input","ArrowLeft","Center alignment","append","Bold","click","key","keydown","block","top","dblClick","_value","38519mOvVaM","_topVerticalAlignOption","min","_directionalMoveZones","serialize","textarea","setAttribute","Justify alignment","appendChild","Lorem ipsum","_verticalAlignOptions","ArrowRight","max","_onStateChange","classList","flipX","altKey","none","linearBurn","move-handle","setVisible","_middleVerticalAlignOption","dispose","524540bThlvd","Italic","bold","multiply","monospace","selectionService","center","state"," Italic","_centerAlignOption","linearDodgeAdd","bind","webpackChunkluna","Middle vertical alignment","_updateText","1149KWAutE","sans-serif","prepend","45mtfQly","3689akYtnl","handleOptionUpdate","Cancel","clientWidth","_model","offsetY","height","alignment","onHistoryUpdateValue","pointerDown","screen"," x ","abs","Set Text Font Size","currentLayer","onCommit","_getRange","_justifyAlignOption","getOutlineSvgPath","isItalic","_blendModeOption","secondaryColor","topright","getDetailedInfo","_cursorCurrent","visible","setValueFromHistoryChange","_alignOptions","devicePixelRatio","Set Text Alignment","#middle","_getLayer","isBold","get","fontFamily","_updateVerticalAlignment","onHistoryAction","getSnapSettingCoordsFromEvent","ArrowUp","_onRequestRender","_textInputDialog","flipY","_getVerticalAlignmentValue","default","primaryColor","_isItalicOption","_container","Text top left position is x=","Blend Mode","stopImmediatePropagation","triggerRequestRender","fantasy","stopPropagation","onLayerChange","fontWeight","verticalAlignment","italic","floor","_rightAlignOption","_elementContainer","Disable","div","left","pointerDownMove","_onUpdate","viewportService","_pointerDownX","_svgPath","stroke","_onOptionsChange","setRange","_leftAlignOption","_setupActiveTemporaryLayer","then","Font size","difference","_rectangleOtherPoint","removeChild","secondary","ctrlKey","_textLayer","Set Text Vertical Alignment","Set Text Blend Mode","_outlineModel","962803RJpzfX","querySelector","Set Text Font Family","_fontFamilyOption","hasImage","display","ArrowDown","fontSize","createElement","type","_sizeInfo","size"," y=","addEventListener","_pointerDownY","strokeWidth","onBeforeRunLayerTask","boolean","set","justify","imageService","Enable","serif","dialog-buttons-row","_updateAlignment","metaKey","_bottomVerticalAlignOption","_directionalMoveElements","rightTriangle","push","_topLeftInfo","_textarea","replace","remove","dialog-box","Text size is ","zoom","width","_moveImageRangeRenderer","dialog-content-row","Move Text","darken","fill","15779EhukYb","keyDown","Shift Text","_updateRect","rgba","middle","string","select","_viewportService","_range","softLight","_fontSizeOption","version","shiftKey","position","options","onHistoryUnset","pointerUp","triangle","_cursorOrigin","Right alignment","_isBoldOption","clientHeight","commit","transparent","topleft","blendMode","onUpdate","_finish","_cursorOriginalRectangle","string-combo","1450851zyeOhf","taskWorkerService","name","range","exclusion","textContent","overlay","_updateStyles","Font family","ellipse","currentState","input","order","onTemporaryLayerRegistered","_svgPath2","_isVisible","_layer","right","178avzkvo","onWillDispose","diamond","style","registerTemporaryLayer","offsetX","125zOkCjm","getPointerState","bottomleft","absolute","round","step","dialog-click-guard","_allowNewState","add","getInfo","_setState","sign","text","shape"," Bold","fire","number"],a24_0x1deb=function(t,s){return a24_0x308d[t-=440]},a24_0x34ccb5=a24_0x1deb;!function(t,s){const i=a24_0x1deb;for(;;)try{if(858649===parseInt(i(464))+-parseInt(i(665))*-parseInt(i(479))+-parseInt(i(441))+parseInt(i(483))*-parseInt(i(482))+-parseInt(i(567))+-parseInt(i(641))+-parseInt(i(610))*-parseInt(i(659)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a24_0x308d),(self.webpackChunkluna=self[a24_0x34ccb5(476)]||[])[a24_0x34ccb5(596)]([[8488,504],{3315:(t,s,i)=>{const e=a24_0x34ccb5;i.d(s,{d:()=>c});var h=i(5120),n=i(1003),o=i(1674);let r,a;class c extends h.JT{constructor(t,s,i,e){const h=a24_0x1deb;super(),this[h(529)]=t,this[h(703)]=s,this[h(618)]=i,this._model=e,this[h(653)]=2,this._svg=document.createElementNS(o.q,"svg"),this[h(684)][h(447)](h(622),h(682)),this[h(684)][h(662)][h(624)]=h(668),this._svgPath=document[h(695)](o.q,"path"),this[h(550)][h(662)].stroke=h(688),this[h(550)][h(662)].fill=h(634),this[h(550)][h(662)][h(582)]="1",this[h(655)]=document[h(695)](o.q,h(687)),this[h(655)][h(662)][h(551)]="var(--luna-focusColor)",this[h(655)][h(662)][h(609)]=h(634),this[h(655)].style[h(582)]="1",this[h(684)][h(716)](this[h(550)],this[h(655)]),this[h(529)][h(481)](this._svg),this.register({dispose:()=>this._container[h(560)](this[h(684)])})}async[e(701)](){const t=e,s=this[t(487)].range,h=this._viewportService;if(!s)return void(this._svg.style.display=t(458));if(this[t(684)][t(662)][t(572)]=t(721),!this[t(703)][t(497)])return;if(r!==this[t(487)][t(678)]){let s;switch(r=this[t(487)].shape,r){case t(661):s=i.e(727)[t(556)](i[t(475)](i,727));break;case t(650):s=i.e(8459)[t(556)](i[t(475)](i,8459));break;case t(628):s=i.e(4012)[t(556)](i[t(475)](i,4012));break;case t(595):s=i.e(6243)[t(556)](i[t(475)](i,6243));break;default:s=void 0}a=s?new Promise((async i=>{const e=t;i(new((await s)[e(526)]))})):s}const o=await a,c=Math[t(669)](this[t(529)].clientWidth/2)-this[t(703)][t(604)]/2*h[t(603)]+h.x*h.zoom,l=Math[t(669)](this[t(529)][t(632)]/2)-this[t(703)].height/2*h[t(603)]+h.y*h[t(603)],p=(0,n.Oq)(s)*h.zoom,d=(0,n.rY)(s)*h.zoom;this[t(684)][t(662)][t(545)]=c+s[t(545)]*h[t(603)]-2+"px",this[t(684)][t(662)][t(722)]=l+s[t(722)]*h.zoom-2+"px",this[t(684)][t(447)]("width",(p+5)[t(693)]()),this._svg.setAttribute(t(489),(d+5).toString()),this._svgPath[t(447)]("d","M2.5 2.5 h"+p+" v"+d+" h"+-p+" v"+-d),o?.[t(501)]?(this[t(655)][t(662)][t(572)]=t(721),this[t(655)][t(447)]("d",o.getOutlineSvgPath(p,d,this[t(487)][t(456)],this[t(487)][t(524)]))):this._svgPath2[t(662)].display="none"}}},9865:(t,s,i)=>{i.d(s,{q:()=>n});var e=i(1815),h=i(5120);class n extends h.JT{constructor(){const t=a24_0x1deb;super(...arguments),this[t(547)]=this[t(691)](new e.v),this.onUpdate=this._onUpdate.event}}},9904:(t,s,i)=>{const e=a24_0x34ccb5;i.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>p,qv:()=>d});var h=i(1815),n=i(5120),o=i(2939);class r extends n.JT{constructor(t,s,i,e=!0){const n=a24_0x1deb;super(),this[n(643)]=t,this[n(571)]=s,this[n(440)]=i,this.allowUnchecking=e,this.type=n(584),this[n(709)]=this[n(691)](new h.v),this[n(491)]=this[n(709)].event,this[n(547)]=this[n(691)](new h.v),this[n(637)]=this[n(547)][n(712)]}get[e(685)](){return this[e(440)]}set[e(685)](t){const s=e;this._value=t,this[s(547)][s(680)](t)}[e(509)](t){const s=e;this[s(440)]=t,this._onHistoryUpdateValue[s(680)](t)}}class a extends n.JT{constructor(t,s,i){const n=e;super(),this[n(643)]=t,this[n(625)]=s,this[n(440)]=i,this[n(576)]=n(616),this[n(709)]=this[n(691)](new h.v),this[n(491)]=this._onHistoryUpdateValue[n(712)],this[n(547)]=this[n(691)](new h.v),this[n(637)]=this._onUpdate[n(712)]}get value(){return this._value}set[e(685)](t){const s=e;this[s(440)]=t,this[s(547)][s(680)](t)}[e(509)](t){const s=e;this[s(440)]=t,this[s(709)][s(680)](t)}}class c extends n.JT{constructor(t,s,i){const n=e;super(),this[n(643)]=t,this.options=s,this[n(440)]=i,this[n(576)]=n(640),this[n(709)]=this[n(691)](new h.v),this.onHistoryUpdateValue=this[n(709)][n(712)],this._onUpdate=this[n(691)](new h.v),this[n(637)]=this[n(547)][n(712)]}get value(){return this[e(440)]}set value(t){const s=e;this._value=t,this[s(547)].fire(t)}setValueFromHistoryChange(t){const s=e;this[s(440)]=t,this._onHistoryUpdateValue[s(680)](t)}}class l extends a{constructor(){const t=e;super(t(531),[t(700),t(599),t(608),t(467),t(459),t(686),t(493),t(474),t(647),"softLight",t(558),t(645)],"normal")}}class p extends n.JT{constructor(t,s,i,n){const o=e;super(),this[o(643)]=t,this[o(440)]=s,this[o(443)]=i,this[o(453)]=n,this[o(576)]=o(681),this[o(709)]=this.register(new h.v),this[o(491)]=this._onHistoryUpdateValue.event,this._onUpdate=this[o(691)](new h.v),this.onUpdate=this[o(547)].event}get[e(685)](){const t=e;return(0,o.u)(this[t(440)],this[t(453)],this[t(443)])}set value(t){const s=e;this[s(440)]=t,this[s(547)][s(680)](t)}setValueFromHistoryChange(t){const s=e;this[s(440)]=t,this[s(709)][s(680)](t)}}class d extends p{constructor(t,s,i,h){const n=e;super(t,s,i,h),this[n(576)]=n(681)}get[e(685)](){const t=e;return(0,o.u)(this[t(440)],this[t(453)],this[t(443)])}set[e(685)](t){const s=e;this[s(440)]=Math[s(540)](t),this._onUpdate[s(680)](t)}}},504:(t,s,i)=>{const e=a24_0x34ccb5;i.r(s),i.d(s,{MoveImageRangeRenderer:()=>o});var h=i(5120),n=i(1003);class o extends h.JT{constructor(t,s,i,e,h){const o=a24_0x1deb;super(),this[o(529)]=t,this[o(499)]=s,this[o(672)]=i,this._viewportService=e,this[o(703)]=h,this.order=2,this[o(594)]=new Map,this[o(444)]=new Map,this[o(656)]=!0,this[o(542)]=document[o(575)](o(544));const r=[o(635),o(505),o(667),o(696),o(722),o(683),o(545),o(658)];for(const t of r){const s=document[o(575)]("div");s[o(455)][o(673)](o(460),t),this[o(542)][o(449)](s),this._directionalMoveElements[o(585)](t,s),this[o(444)][o(585)](t,(0,n.Pq)())}this[o(529)].appendChild(this[o(542)]),this[o(691)]({dispose:()=>{const t=o;this[t(529)][t(560)](this[t(542)])}})}[e(461)](t){const s=e;t!==this[s(656)]&&(this[s(542)].style[s(572)]=t?"":s(458),this[s(656)]=t)}[e(553)](t){}[e(701)](){const t=e,s=this[t(499)]();if(!s)return;const i=this[t(703)][t(497)];if(!i)return;const h=this._viewportService,n=Math[t(669)](this[t(529)][t(486)]/2)-i[t(604)]/2*h[t(603)],o=Math.round(this[t(529)][t(632)]/2)-i.height/2*h[t(603)],r=n+(h.x+s[t(545)])*h[t(603)],a=o+(h.y+s[t(722)])*h[t(603)],c=n+(h.x+s.right)*h[t(603)],l=o+(h.y+s[t(683)])*h[t(603)],p=Math[t(669)]((r+c)/2),d=Math.round((a+l)/2),g=10*window[t(511)],u={left:Math[t(443)](r+g,Math[t(453)](r,p-g)),top:Math[t(443)](a+g,Math[t(453)](a,d-g)),right:Math[t(453)](c-g,Math[t(443)](c,p+g)),bottom:Math[t(453)](l-g,Math[t(443)](l,d+g))},_={left:r-g,top:a-g,right:c+g,bottom:l+g},m=this[t(444)][t(516)](t(635));m[t(545)]=_[t(545)],m.right=u[t(545)],m[t(722)]=_[t(722)],m.bottom=u[t(722)];const v=this[t(594)][t(516)]("topleft");v.style[t(545)]=r+"px",v[t(662)].top=a+"px";const f=this._directionalMoveZones[t(516)](t(505));f[t(545)]=u[t(658)],f[t(658)]=_[t(658)],f[t(722)]=_[t(722)],f[t(683)]=u[t(722)];const y=this[t(594)][t(516)](t(505));y[t(662)].left=c+"px",y[t(662)].top=a+"px";const x=this[t(444)][t(516)]("bottomleft");x[t(545)]=_[t(545)],x.right=u[t(545)],x[t(722)]=u[t(683)],x[t(683)]=_[t(683)];const b=this[t(594)].get(t(667));b.style[t(545)]=r+"px",b[t(662)].top=l+"px";const w=this[t(444)][t(516)]("bottomright");w[t(545)]=u[t(658)],w.right=_.right,w[t(722)]=u[t(683)],w[t(683)]=_[t(683)];const O=this[t(594)][t(516)](t(696));O.style[t(545)]=c+"px",O[t(662)][t(722)]=l+"px";const M=this[t(444)][t(516)](t(722));M[t(545)]=u.left,M[t(658)]=u[t(658)],M.top=_[t(722)],M[t(683)]=u[t(722)];const S=this[t(594)][t(516)]("top");S.style.left=p+"px",S.style[t(722)]=a+"px";const C=this[t(444)][t(516)](t(683));C[t(545)]=u[t(545)],C[t(658)]=u[t(658)],C[t(722)]=u[t(683)],C.bottom=_.bottom;const V=this._directionalMoveElements[t(516)]("bottom");V[t(662)].left=p+"px",V.style[t(722)]=l+"px";const L=this[t(444)][t(516)](t(545));L[t(545)]=_[t(545)],L[t(658)]=u.left,L[t(722)]=u[t(722)],L[t(683)]=u[t(683)];const R=this[t(594)][t(516)](t(545));R[t(662)][t(545)]=r+"px",R[t(662)][t(722)]=d+"px";const A=this[t(444)][t(516)]("right");A[t(545)]=u[t(658)],A.right=_[t(658)],A[t(722)]=u.top,A[t(683)]=u[t(683)];const k=this._directionalMoveElements[t(516)](t(658));k[t(662)].left=c+"px",k[t(662)][t(722)]=d+"px"}[e(666)](t){const s=e;if(!this[s(499)]())return this[s(672)]?s(697):"move";for(const[i,e]of this[s(444)])if((0,n.RB)(e,t[s(664)],t.offsetY))return i;const i=this[s(444)][s(516)](s(635)),h=this._directionalMoveZones.get(s(696)),o={left:i[s(545)],top:i.top,right:h[s(658)],bottom:h[s(683)]};return(0,n.RB)(o,t[s(664)],t[s(488)])?s(689):this._allowNewState?s(697):s(689)}}},8488:(t,s,i)=>{const e=a24_0x34ccb5;i.r(s),i.d(s,{default:()=>_});var h=i(1815),n=i(5120),o=i(1003),r=i(3315),a=i(504),c=i(7233),l=i(9904),p=i(8752),d=i(9865),g=i(7896);class u extends n.JT{constructor(t){const s=a24_0x1deb;super(),this[s(704)]=t,this.id=s(677),this.state="new",this[s(566)]=new m((()=>this[s(563)])),this[s(503)]=new l.Jp,this[s(570)]=new l.tv(s(649),[s(589),s(480),s(468),s(702),s(534)],s(480)),this[s(621)]=new l.qv(s(557),16,1,1e3),this[s(631)]=new l.FV(s(717),!0,!1),this[s(528)]=new l.FV(s(465),!0,!1),this[s(554)]=new l.FV(s(698),!0,!0,!1),this[s(473)]=new l.FV(s(715),!0,!1,!1),this[s(541)]=new l.FV(s(630),!0,!1,!1),this._justifyAlignOption=new l.FV(s(448),!0,!1,!1),this[s(442)]=new l.FV("Top vertical alignment",!0,!0,!1),this._middleVerticalAlignOption=new l.FV(s(477),!0,!1,!1),this[s(593)]=new l.FV("Bottom vertical alignment",!0,!1,!1),this[s(510)]=[this[s(554)],this._centerAlignOption,this[s(541)],this[s(500)]],this[s(451)]=[this[s(442)],this[s(462)],this._bottomVerticalAlignOption],this[s(625)]=[this[s(503)],this[s(570)],this[s(621)],this[s(631)],this._isItalicOption,...this[s(510)],...this._verticalAlignOptions],this[s(577)]=new v,this[s(597)]=new f,this.info=[this[s(597)],this._sizeInfo],this[s(522)]=this.register(new h.v),this.onRequestRender=this._onRequestRender[s(712)],this[s(454)]=this[s(691)](new h.v),this.onStateChange=this[s(454)][s(712)],this[s(691)](this[s(704)].paletteService.onUpdate((()=>this._updateColors()))),this[s(691)](this[s(503)][s(637)]((t=>this[s(563)]?.[s(484)](t,"blendMode",s(565))))),this[s(691)](this[s(570)].onUpdate((t=>this._textLayer?.[s(484)](t,s(517),s(569),!0)))),this[s(691)](this._fontSizeOption[s(637)]((t=>this._textLayer?.[s(484)](t,s(574),s(496),!0)))),this.register(this[s(631)].onUpdate((t=>this[s(563)]?.[s(484)](t,s(515),(t?s(588):"Disable")+s(679))))),this[s(691)](this[s(528)][s(637)]((t=>this._textLayer?.[s(484)](t,s(502),s(t?588:543)+s(472)))));for(const t of this[s(510)])this.register(t[s(637)]((()=>this[s(591)](t))));for(const t of this[s(451)])this[s(691)](t[s(637)]((()=>this[s(518)](t))));this[s(691)](this[s(704)].imageService[s(536)]((()=>this[s(638)]()))),this[s(691)](this[s(704)].taskService[s(583)]((()=>this[s(638)]()))),this.register((0,n.OF)((()=>this[s(638)]()))),this[s(691)]((0,n.OF)((()=>this._textInputDialog?.dispose()))),this[s(691)](this[s(704)][s(587)][s(654)]((t=>this[s(555)](t)))),this[s(704)][s(587)][s(497)]?.temporaryLayer&&this[s(555)](this[s(704)][s(587)][s(497)].temporaryLayer)}[e(555)](t){const s=e;t.type===s(677)&&(this._textLayer=t,this.register(this[s(563)][s(498)]((()=>this[s(711)]()))),this[s(691)](this._textLayer[s(519)]((()=>{const t=s;this[t(552)](),this[t(690)]()}))),this[s(691)](this[s(563)][s(626)]((()=>this[s(711)]()))),this[s(559)]=[this._textLayer[s(651)][s(644)][s(658)],this[s(563)][s(651)][s(644)][s(683)]],this._moveImageRangeRenderer?.[s(461)](!0),this._onRequestRender[s(680)]())}[e(690)](){const t=e,s=this[t(563)]?(0,o.FJ)(this[t(563)][t(651)][t(644)]):void 0;this[t(577)][t(644)]=s,this[t(597)][t(644)]=s}[e(611)](t,s){const i=e;if(this[i(563)]&&!s&&["ArrowUp",i(714),i(573),i(452)].includes(t[i(719)])){const s=(0,o.BN)(this[i(563)][i(651)][i(644)]),e=(g.V5?t[i(592)]:t[i(562)])?10:1;switch(t[i(719)]){case i(521):(0,o.Hd)(s,s[i(545)],s[i(722)]-e);break;case"ArrowDown":(0,o.Hd)(s,s[i(545)],s.top+e);break;case i(714):(0,o.Hd)(s,s[i(545)]-e,s[i(722)]);break;case i(452):(0,o.Hd)(s,s.left+e,s.top)}this[i(563)][i(651)][i(644)]=s,this._textLayer[i(670)](i(612))}}async[e(492)](t){const s=e,i=this._sc.imageService[s(497)];if(!i)return;const h=!(1&t.buttons);this[s(549)]=t[s(664)],this._pointerDownY=t[s(488)];const n=this._sc[s(548)][s(520)](t,!1);if(this._cursorOrigin=n,this._cursorCurrent=n,"new"!==this[s(471)])return this._cursorOriginalRectangle=(0,o.BN)(this[s(563)]?.[s(651)][s(644)]),void(this[s(639)]&&((this[s(471)]===s(722)||this[s(471)]===s(635)||this[s(471)]===s(505))&&(this[s(629)][1]=this._cursorOriginalRectangle[s(722)]),("bottom"===this.state||"bottomleft"===this[s(471)]||this[s(471)]===s(696))&&(this._cursorOrigin[1]=this[s(639)][s(683)]-1),("left"===this[s(471)]||this[s(471)]===s(635)||"bottomleft"===this[s(471)])&&(this[s(629)][0]=this[s(639)][s(545)]),(this[s(471)]===s(658)||"topright"===this[s(471)]||this[s(471)]===s(696))&&(this[s(629)][0]=this._cursorOriginalRectangle[s(658)]-1)));await this[s(638)](),this[s(559)]=n;const r=this._createRange(this[s(629)],this[s(507)]);this._cursorOriginalRectangle=(0,o.BN)(r),this[s(563)]=new c.o(i,{invertColors:h},{primaryColor:this[s(704)][s(705)][s(706)][s(614)],secondaryColor:this[s(704)][s(705)][s(561)].rgba,blendMode:this[s(503)][s(685)],range:r,text:s(450),isBold:this[s(631)][s(685)],isItalic:this[s(528)][s(685)],fontSize:this[s(621)][s(685)],fontFamily:this[s(570)][s(685)],alignment:this[s(694)](),verticalAlignment:this[s(525)]()},this[s(704)].historyService,this[s(704)][s(469)],this[s(704)][s(642)]),this[s(690)](),await i[s(663)](this[s(563)]),this[s(605)]?.setVisible(!1),this[s(563)][s(533)]()}[e(546)](t){const s=e;if(void 0===this[s(549)]||void 0===this[s(581)]||!this._cursorOrigin||!this[s(559)]||!this[s(639)])return;const i=this[s(704)][s(548)].getSnapSettingCoordsFromEvent(t,!1);if(this[s(507)]&&i[0]===this[s(507)][0]&&i[1]===this[s(507)][1])return;if(this._cursorCurrent=i,!this[s(563)])return;const h=this[s(507)][0]-this[s(629)][0],n=this[s(507)][1]-this[s(629)][1];switch(this[s(471)]){case s(697):return this[s(559)]=i,void this[s(613)](t,!0);case s(689):{const t=(0,o.BN)(this._cursorOriginalRectangle);t[s(545)]+=h,t.top+=n,t[s(658)]+=h,t.bottom+=n,(0,o.FJ)(t),this[s(563)][s(651)][s(644)]=t;break}default:{let i;if(!t.shiftKey||"topleft"!==this[s(471)]&&this.state!==s(505)&&this[s(471)]!==s(667)&&this[s(471)]!==s(696))i=(0,o.BN)(this[s(639)]),(this.state===s(722)||this.state===s(635)||this[s(471)]===s(505))&&(i[s(722)]+=n,i[s(683)]<=i[s(722)]&&i.top++,t[s(457)]&&(i[s(683)]-=n)),(this.state===s(683)||this[s(471)]===s(667)||"bottomright"===this[s(471)])&&(i[s(683)]+=n,i.bottom<=i[s(722)]&&i[s(683)]--,t[s(457)]&&(i[s(722)]-=n)),(this[s(471)]===s(545)||this.state===s(635)||"bottomleft"===this[s(471)])&&(i[s(545)]+=h,i[s(658)]<=i[s(545)]&&i[s(545)]++,t[s(457)]&&(i[s(658)]-=h)),("right"===this.state||this.state===s(505)||this.state===s(696))&&(i.right+=h,i[s(658)]<=i[s(545)]&&i[s(658)]--,t[s(457)]&&(i.left-=h));else{const e=(0,o.n3)(this._cursorOriginalRectangle);let r;switch(i=(0,o.BN)(this._cursorOriginalRectangle),this[s(471)]){case s(635):r=(1/e*-h-n)/2,i[s(545)]-=Math[s(669)](r*e),i[s(722)]-=Math[s(669)](r),t[s(457)]&&(i[s(658)]+=Math[s(669)](r*e),i[s(683)]+=Math[s(669)](r));break;case s(505):r=(h*(1/e)-n)/2,i.right+=Math[s(669)](r*e),i.top-=Math[s(669)](r),t[s(457)]&&(i[s(545)]-=Math[s(669)](r*e),i[s(683)]+=Math[s(669)](r));break;case s(667):r=(1/e*-h+n)/2,i.left-=Math[s(669)](r*e),i.bottom+=Math[s(669)](r),t.altKey&&(i.right+=Math.round(r*e),i[s(722)]-=Math[s(669)](r));break;case"bottomright":r=(h*(1/e)+n)/2,i[s(658)]+=Math[s(669)](r*e),i[s(683)]+=Math[s(669)](r),t.altKey&&(i[s(545)]-=Math[s(669)](r*e),i[s(722)]-=Math[s(669)](r))}}this[s(563)][s(651)][s(644)]=(0,o.FJ)(i);break}}this[s(690)](),this._textLayer[s(533)]()}[e(699)](t,s){const i=e;this[i(605)]&&!s&&this[i(675)](this[i(605)][i(666)](t))}[e(723)](t){const s=e;!this[s(523)]&&this[s(563)]&&"move"===this[s(471)]&&(this[s(523)]=new y(this._textLayer,this[s(570)],this[s(621)],this[s(631)],this[s(528)]),this[s(523)].onWillDispose((()=>this[s(523)]=void 0)))}async[e(627)](t,s){const i=e;if(this[i(471)]===i(697)&&(s||this[i(507)]?.[0]===this[i(629)]?.[0]&&this._cursorCurrent?.[1]===this[i(629)]?.[1]))return this[i(563)]&&this[i(704)][i(587)][i(497)]?.unregisterTemporaryLayer(this[i(563)]),this._textLayer?.[i(463)](),void this[i(711)]();if(this[i(563)]){let t;switch(this[i(471)]){case i(697):t="Draw Text";break;case i(689):if(s)return;t=i(607);break;case i(635):case"topright":case i(667):case i(696):case i(722):case i(545):case i(658):case i(683):t=i(708)}this._textLayer[i(670)](t)}this[i(605)]?.setVisible(!0),this[i(699)](t,!1)}_updateColors(){const t=e;if(!this[t(563)])return;const s=this[t(704)][t(705)][t(706)],i=this[t(704)][t(705)][t(561)];(0,p.WC)(this[t(563)][t(651)][t(527)],s[t(614)])&&(0,p.WC)(this._textLayer[t(651)][t(504)],i.rgba)||(this[t(563)][t(651)][t(527)]=s[t(614)],this[t(563)][t(651)].secondaryColor=i.rgba,this._textLayer[t(670)]("Set Text Color",!0),this[t(563)][t(533)]())}async[e(591)](t){const s=e;for(const i of this[s(510)])i!==t&&i[s(509)](!1);this[s(563)]?.[s(484)](this[s(694)](),s(490),s(512))}async[e(518)](t){const s=e;for(const i of this[s(451)])i!==t&&i.setValueFromHistoryChange(!1);this[s(563)]?.handleOptionUpdate(this[s(525)](),"verticalAlignment",s(564))}[e(694)](){const t=e;return this._leftAlignOption.value?t(545):this._centerAlignOption[t(685)]?t(470):this._rightAlignOption.value?t(658):t(586)}[e(525)](){const t=e;return this._topVerticalAlignOption[t(685)]?t(722):this._middleVerticalAlignOption[t(685)]?t(615):"bottom"}[e(552)](){const t=e;this[t(563)]&&(this[t(503)][t(509)](this[t(563)][t(651)][t(636)]),this[t(570)][t(509)](this[t(563)].currentState.fontFamily),this._fontSizeOption.setValueFromHistoryChange(this._textLayer[t(651)][t(574)]),this[t(631)].setValueFromHistoryChange(this._textLayer[t(651)][t(515)]),this[t(528)][t(509)](this._textLayer.currentState.isItalic),this[t(554)][t(509)]("left"===this._textLayer[t(651)].alignment),this[t(473)][t(509)](this[t(563)][t(651)].alignment===t(470)),this[t(541)][t(509)](this[t(563)][t(651)][t(490)]===t(658)),this[t(500)][t(509)](this[t(563)][t(651)][t(490)]===t(586)),this._topVerticalAlignOption[t(509)]("top"===this[t(563)].currentState[t(538)]),this._middleVerticalAlignOption[t(509)](this[t(563)][t(651)][t(538)]===t(615)),this._bottomVerticalAlignOption[t(509)](this[t(563)][t(651)][t(538)]===t(683)),(!(0,p.WC)(this._sc.paletteService[t(706)].rgba,this[t(563)][t(651)].primaryColor)||!(0,p.WC)(this[t(704)][t(705)][t(561)][t(614)],this[t(563)][t(651)][t(504)]))&&this[t(704)][t(705)].setColors(this[t(563)][t(651)].primaryColor,this[t(563)][t(651)].secondaryColor))}[e(675)](t){const s=e;this[s(471)]!==t&&(this[s(471)]=t,this._onStateChange[s(680)]())}_updateRect(t,s){const i=e;if(!s||!this[i(629)]||!this[i(507)])return;let h=this[i(629)][0]-this[i(507)][0],n=this._cursorOrigin[1]-this[i(507)][1];t[i(623)]&&(Math.abs(h)>Math[i(495)](n)?h=n*(Math[i(676)](h)!==Math.sign(n)?-1:1):n=h*(Math[i(676)](h)!==Math[i(676)](n)?-1:1));const o=t.altKey?[this._cursorOrigin[0]+h,this[i(629)][1]+n]:this[i(629)],r=this[i(707)](o,[this[i(629)][0]-h,this[i(629)][1]-n]);this[i(563)]&&(this[i(563)][i(651)][i(644)]=r),this[i(522)].fire()}_createRange(t,s){return(0,o.tH)(t[0],t[1],s[0],s[1])}async[e(638)](){const t=e;await(this[t(563)]?.[t(633)]()),this._clearLayer()}_clearLayer(){const t=e;this._textLayer=void 0,this[t(605)]?.[t(461)](!1),this[t(690)](),this[t(522)][t(680)]()}createDomRenderProgram(t){const s=e;return this[s(605)]=new a.MoveImageRangeRenderer(t,(()=>this[s(563)]?.[s(651)][s(644)]),!0,this[s(704)][s(548)],this[s(704)].imageService),this[s(605)][s(461)](this[s(471)]!==s(697)),[this[s(605)],new r.d(t,this[s(704)].imageService,this[s(704)][s(548)],this[s(566)])]}[e(445)](){return{state:this.state,hasTextLayer:!!this._textLayer}}[e(692)](t){const s=e;t.hasTextLayer?this[s(605)]?.[s(461)](!0):this[s(711)](),this[s(675)](t[s(471)]),this[s(552)](),this[s(690)]()}}const _=u;class m{constructor(t){this[e(514)]=t}get[e(644)](){const t=e;return this[t(514)]()?.[t(651)][t(644)]}}class v extends d.q{constructor(){const t=e;super(...arguments),this[t(576)]=t(578)}get[e(644)](){return this[e(619)]}set[e(644)](t){const s=e;this[s(619)]=t,this[s(547)][s(680)]()}get visible(){return!!this[e(619)]}getInfo(){const t=e;if(!this[t(619)])return"";const s=(0,o.Oq)(this._range),i=(0,o.rY)(this._range);return s+t(494)+i}[e(506)](){const t=e;if(!this._range)return"";const s=(0,o.Oq)(this[t(619)]),i=(0,o.rY)(this[t(619)]);return t(602)+s+" pixels wide by "+i+" pixels tall"}}class f extends d.q{constructor(){const t=e;super(...arguments),this[t(576)]="topleft"}get[e(644)](){return this[e(619)]}set[e(644)](t){const s=e;this[s(619)]=t,this[s(547)][s(680)]()}get[e(508)](){return!!this[e(619)]}[e(674)](){const t=e;return this._range?this[t(619)][t(545)]+", "+this[t(619)][t(722)]:""}getDetailedInfo(){const t=e;return this[t(619)]?t(530)+this[t(619)][t(545)]+t(579)+this[t(619)][t(722)]:""}}class y extends n.JT{constructor(t,s,i,o,r){const a=e;super(),this[a(657)]=t,this[a(570)]=s,this._fontSizeOption=i,this[a(631)]=o,this[a(528)]=r,this._onWillDispose=this[a(691)](new h.v),this[a(660)]=this._onWillDispose[a(712)],this[a(691)](this[a(570)][a(637)]((()=>this[a(648)]()))),this[a(691)](this[a(621)].onUpdate((()=>this[a(648)]()))),this[a(691)](this[a(631)][a(637)]((()=>this[a(648)]()))),this[a(691)](this._isItalicOption.onUpdate((()=>this[a(648)]())));const c=document[a(575)](a(544));c[a(455)][a(673)](a(671)),c[a(580)]("click",(t=>t[a(535)]()));const l=document.createElement("div");l[a(455)][a(673)](a(606)),this[a(598)]=document[a(575)](a(446));const p=this._layer[a(651)].text;this[a(598)].value=p,this[a(598)][a(455)][a(673)](a(713)),this[a(598)][a(580)](a(720),(t=>t[a(532)]())),this._textarea[a(580)](a(652),(t=>this[a(478)](this._textarea[a(685)]))),l[a(716)](this._textarea);const d=document[a(575)](a(544));d[a(455)][a(673)](a(590));const u=document.createElement("button");u[a(646)]="OK",u[a(580)](a(718),(()=>this.dispose()));const _=document[a(575)]("button");_[a(646)]=a(485),_[a(580)]("click",(()=>{const t=a;this[t(478)](p),m[t(600)](),this[t(463)]()})),g.V5?d[a(716)](_,u):d.append(u,_);const m=document.createElement("div");m[a(455)][a(673)](a(601)),m.append(l,d),document[a(568)](a(513))[a(716)](c,m),this[a(598)][a(617)](),this[a(691)]((0,n.OF)((()=>{const t=a;c.remove(),m[t(600)]()})))}[e(463)](){const t=e;this._onWillDispose[t(680)](),super[t(463)]()}[e(648)](){const t=e;this._textarea[t(662)][t(517)]=this[t(570)].value,this[t(598)][t(662)][t(574)]=this[t(621)][t(685)]+"px",this._textarea[t(662)][t(537)]=this._isBoldOption[t(685)]?t(466):"",this[t(598)].style.fontStyle=this[t(528)][t(685)]?t(539):""}[e(478)](t){const s=e;this[s(657)]&&this._layer[s(651)].text!==t&&(this[s(657)][s(651)][s(677)]=t,this[s(657)][s(670)]("Update Text",!0),this[s(657)][s(533)]())}}},1674:(t,s,i)=>{const e=a24_0x34ccb5;i.d(s,{q:()=>h});const h=e(710)}}]);