"use strict";const a12_0x43b9=["primary","prepend","101 x 101 Average","normal","options","setAttribute","createDomRenderProgram","_viewportService","5 x 5 Average","imageService","1.1","screen","webpackChunkluna","setValueFromHistoryChange","var(--luna-focusColor)","_samplingOption","fire","version","min","none","style","rgba","range","boolean","createReadonlyRgbaColor","_imageService","linearDodgeAdd","74ruziJm","_setColor","_updateOutline","31 x 31 Average","linearBurn","getCoordsFromEvent","paletteService","diamond","toString","type","3 x 3 Average","bind","viewportService","height","value","shape","Blend Mode","_onRequestRender","number","exclusion","11 x 11 Average","currentLayer","absolute","name","376718DWKBRk","60452PHTFRL","zoom","round","then","hasImage","181WPxeIP","difference","ellipse","onHistoryUpdateValue","_onUpdate","pointerDown","display","multiply","event","192198AejNMc","onRequestRender","pointerMove","top","strokeWidth","colorPicker","_outlineModel","softLight","_value","push","_lastCoord","onUpdate","allowUnchecking","fill","Sampling","stroke","overlay","containsCoord","register","width","clientHeight","flipX","render","max","rightTriangle","51 x 51 Average","transparent","triangle","64786lIywjR","createElementNS","51123XhsuZc","Point","get","default","755Hjnwqf","left","_sc","append","_svgPath","darken","getOutlineSvgPath","removeChild","string-combo","path","pointerUp","lighten","flipY","_onHistoryUpdateValue","buttons","secondary","1478VpsjCc","http://www.w3.org/2000/svg","_model","_svg","1txLgbS","position","block","floor","_svgPath2","_container"],a12_0x13ca=function(t,s){return a12_0x43b9[t-=399]},a12_0x489da6=a12_0x13ca;!function(t,s){const e=a12_0x13ca;for(;;)try{if(101780===-parseInt(e(430))-parseInt(e(400))+parseInt(e(454))*-parseInt(e(428))+-parseInt(e(487))*-parseInt(e(450))+parseInt(e(434))*-parseInt(e(517))+parseInt(e(512))+parseInt(e(511)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a12_0x43b9),(self.webpackChunkluna=self[a12_0x489da6(472)]||[])[a12_0x489da6(409)]([[6471],{3315:(t,s,e)=>{const i=a12_0x489da6;e.d(s,{d:()=>c});var n=e(5120),h=e(1003),r=e(1674);let a,o;class c extends n.JT{constructor(t,s,e,i){const n=a12_0x13ca;super(),this[n(459)]=t,this[n(485)]=s,this[n(467)]=e,this[n(452)]=i,this.order=2,this[n(453)]=document[n(429)](r.q,"svg"),this._svg[n(465)](n(477),n(470)),this._svg.style[n(455)]=n(509),this[n(438)]=document.createElementNS(r.q,n(443)),this[n(438)].style.stroke=n(474),this[n(438)][n(480)][n(413)]=n(426),this[n(438)][n(480)][n(404)]="1",this[n(458)]=document[n(429)](r.q,n(443)),this[n(458)].style[n(415)]=n(474),this[n(458)][n(480)][n(413)]=n(426),this[n(458)].style[n(404)]="1",this[n(453)][n(437)](this._svgPath,this[n(458)]),this[n(459)][n(461)](this[n(453)]),this[n(418)]({dispose:()=>this[n(459)][n(441)](this[n(453)])})}async[i(422)](){const t=i,s=this[t(452)][t(482)],n=this[t(467)];if(!s)return void(this[t(453)][t(480)].display=t(479));if(this._svg[t(480)][t(523)]=t(456),!this._imageService[t(508)])return;if(a!==this._model[t(502)]){let s;switch(a=this[t(452)].shape,a){case t(494):s=e.e(727)[t(515)](e[t(498)](e,727));break;case t(519):s=e.e(8459)[t(515)](e[t(498)](e,8459));break;case t(427):s=e.e(4012)[t(515)](e[t(498)](e,4012));break;case t(424):s=e.e(6243)[t(515)](e[t(498)](e,6243));break;default:s=void 0}o=s?new Promise((async e=>{const i=t;e(new((await s)[i(433)]))})):s}const r=await o,c=Math.round(this[t(459)].clientWidth/2)-this[t(485)][t(419)]/2*n[t(513)]+n.x*n.zoom,l=Math[t(514)](this[t(459)][t(420)]/2)-this[t(485)][t(500)]/2*n[t(513)]+n.y*n[t(513)],u=(0,h.Oq)(s)*n[t(513)],d=(0,h.rY)(s)*n.zoom;this._svg.style[t(435)]=c+s[t(435)]*n[t(513)]-2+"px",this[t(453)].style[t(403)]=l+s[t(403)]*n[t(513)]-2+"px",this[t(453)].setAttribute(t(419),(u+5).toString()),this._svg[t(465)](t(500),(d+5)[t(495)]()),this._svgPath[t(465)]("d","M2.5 2.5 h"+u+" v"+d+" h"+-u+" v"+-d),r?.[t(440)]?(this[t(458)][t(480)][t(523)]="block",this[t(458)][t(465)]("d",r[t(440)](u,d,this[t(452)][t(421)],this[t(452)][t(446)]))):this[t(458)][t(480)][t(523)]=t(479)}}},9904:(t,s,e)=>{const i=a12_0x489da6;e.d(s,{FV:()=>a,rP:()=>o,tv:()=>c,Jp:()=>l,X5:()=>u,qv:()=>d});var n=e(1815),h=e(5120),r=e(2939);class a extends h.JT{constructor(t,s,e,i=!0){const h=a12_0x13ca;super(),this[h(510)]=t,this[h(516)]=s,this[h(408)]=e,this[h(412)]=i,this[h(496)]=h(483),this[h(447)]=this[h(418)](new n.v),this[h(520)]=this[h(447)][h(399)],this[h(521)]=this[h(418)](new n.v),this[h(411)]=this[h(521)].event}get value(){return this._value}set value(t){const s=a12_0x13ca;this._value=t,this[s(521)][s(476)](t)}[i(473)](t){const s=i;this[s(408)]=t,this[s(447)][s(476)](t)}}class o extends h.JT{constructor(t,s,e){const h=i;super(),this[h(510)]=t,this[h(464)]=s,this[h(408)]=e,this[h(496)]="string",this[h(447)]=this[h(418)](new n.v),this[h(520)]=this[h(447)][h(399)],this[h(521)]=this[h(418)](new n.v),this[h(411)]=this._onUpdate[h(399)]}get[i(501)](){return this[i(408)]}set[i(501)](t){const s=i;this[s(408)]=t,this[s(521)][s(476)](t)}[i(473)](t){const s=i;this[s(408)]=t,this._onHistoryUpdateValue[s(476)](t)}}class c extends h.JT{constructor(t,s,e){const h=i;super(),this.name=t,this[h(464)]=s,this[h(408)]=e,this[h(496)]=h(442),this[h(447)]=this.register(new n.v),this.onHistoryUpdateValue=this[h(447)].event,this._onUpdate=this[h(418)](new n.v),this[h(411)]=this._onUpdate.event}get[i(501)](){return this[i(408)]}set[i(501)](t){const s=i;this._value=t,this[s(521)][s(476)](t)}setValueFromHistoryChange(t){const s=i;this._value=t,this[s(447)][s(476)](t)}}class l extends o{constructor(){const t=i;super(t(503),["normal","replace",t(439),t(524),"linearBurn",t(445),t(471),t(486),t(416),t(407),"difference",t(506)],t(463))}}class u extends h.JT{constructor(t,s,e,h){const r=i;super(),this[r(510)]=t,this[r(408)]=s,this[r(478)]=e,this[r(423)]=h,this[r(496)]=r(505),this[r(447)]=this.register(new n.v),this[r(520)]=this[r(447)][r(399)],this._onUpdate=this[r(418)](new n.v),this[r(411)]=this[r(521)].event}get value(){const t=i;return(0,r.u)(this[t(408)],this[t(423)],this[t(478)])}set[i(501)](t){const s=i;this[s(408)]=t,this[s(521)].fire(t)}setValueFromHistoryChange(t){const s=i;this[s(408)]=t,this[s(447)][s(476)](t)}}class d extends u{constructor(t,s,e,n){const h=i;super(t,s,e,n),this[h(496)]=h(505)}get value(){const t=i;return(0,r.u)(this[t(408)],this[t(423)],this[t(478)])}set[i(501)](t){const s=i;this[s(408)]=Math[s(457)](t),this[s(521)][s(476)](t)}}},6471:(t,s,e)=>{const i=a12_0x489da6;e.r(s),e.d(s,{default:()=>u});var n=e(8752),h=e(1815),r=e(5120),a=e(3315),o=e(9904);const c=new Map([[i(431),0],[i(497),1],[i(468),2],[i(507),5],[i(490),15],[i(425),25],[i(462),50]]);class l extends r.JT{constructor(t){const s=i;super(),this._sc=t,this.id=s(405),this[s(475)]=new o.rP(s(414),[s(431),"3 x 3 Average","5 x 5 Average",s(507),s(490),s(425),"101 x 101 Average"],s(431)),this[s(464)]=[this[s(475)]],this._outlineModel={range:void 0},this[s(504)]=this.register(new h.v),this[s(401)]=this._onRequestRender[s(399)]}[i(466)](t){const s=i;return new a.d(t,this[s(436)][s(469)],this[s(436)][s(499)],this[s(406)])}[i(522)](t){const s=i;if(!this._sc.imageService[s(508)])return;const e=this[s(436)][s(499)].getCoordsFromEvent(t);this[s(489)](e),this[s(436)].imageService[s(417)](e[0],e[1])&&this[s(488)](e,t),this[s(410)]=e}[i(444)](){const t=i;this[t(436)][t(469)].currentLayer&&(this[t(410)]=void 0)}[i(402)](t,s){const e=i;if(!this[e(436)][e(469)][e(508)])return;const n=this[e(436)].viewportService[e(492)](t);this._updateOutline(n),s&&this[e(410)]&&(this[e(436)][e(469)][e(417)](n[0],n[1])&&(this[e(410)][0]!==n[0]||this._lastCoord[1]!==n[1])&&this[e(488)](n,t),this[e(410)]=n)}_updateOutline(t){const s=i;if(this[s(436)][s(469)][s(508)]&&(this._outlineModel.range?.[s(435)]!==t[0]||this[s(406)][s(482)]?.[s(403)]!==t[1])){if(this[s(436)].imageService[s(417)](t[0],t[1])){const e=c[s(432)](this[s(475)][s(501)]);this[s(406)][s(482)]={left:t[0]-e,top:t[1]-e,right:t[0]+e+1,bottom:t[1]+e+1}}else this[s(406)].range=void 0;this._onRequestRender[s(476)]()}}[i(488)](t,s){const e=i,h=this[e(436)][e(469)][e(508)];if(!h)return;const r=h.data;let a;if("Point"===this[e(475)].value){const s=4*(t[1]*h[e(419)]+t[0]);a=n.m4[e(484)](r[s],r[s+1],r[s+2],r[s+3])}else{const s=c[e(432)](this[e(475)][e(501)]);let i=0,o=0,l=0,u=0;const d=Math.max(t[0]-s,0),v=Math.max(t[1]-s,0),p=Math[e(478)](t[0]+s,h.width-1),g=Math[e(478)](t[1]+s,h[e(500)]-1);let _=0;for(let t=v;t<=g;t++)for(let s=d;s<=p;s++)_=4*(t*h[e(419)]+s),i+=r[_],o+=r[_+1],l+=r[_+2],u+=r[_+3];const m=(p-d+1)*(g-v+1);a=n.m4[e(484)](Math[e(514)](i/m),Math[e(514)](o/m),Math[e(514)](l/m),Math[e(514)](u/m))}1&s.buttons?this[e(436)][e(493)][e(460)][e(481)]=a:2&s[e(448)]&&(this[e(436)][e(493)][e(449)][e(481)]=a)}}const u=l},1674:(t,s,e)=>{const i=a12_0x489da6;e.d(s,{q:()=>n});const n=i(451)}}]);